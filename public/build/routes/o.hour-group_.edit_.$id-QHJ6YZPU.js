import{a as it}from"/build/_shared/chunk-3DB3GQTY.js";import{a as G}from"/build/_shared/chunk-XDNDK56N.js";import"/build/_shared/chunk-KAUQO2FD.js";import"/build/_shared/chunk-7ZNTUDLC.js";import{a as ot}from"/build/_shared/chunk-6JFOYO3V.js";import{a as O}from"/build/_shared/chunk-L2TBXS32.js";import{a as q}from"/build/_shared/chunk-A762UFCP.js";import"/build/_shared/chunk-RHTBOEYQ.js";import"/build/_shared/chunk-HNF2M344.js";import"/build/_shared/chunk-IQV4D3C7.js";import"/build/_shared/chunk-H33OI7YH.js";import{a as W}from"/build/_shared/chunk-JBQJJPFB.js";import{b as r}from"/build/_shared/chunk-SS7AQOQ3.js";import{a as j,b as B,c as M}from"/build/_shared/chunk-2MHSPA7K.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as o}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-XNZ6DBKW.js";import"/build/_shared/chunk-YYMCCM4Y.js";import{a as mt}from"/build/_shared/chunk-35S5HMBT.js";import"/build/_shared/chunk-2BPW44Z6.js";import"/build/_shared/chunk-5KYGR3MA.js";import"/build/_shared/chunk-KLKNQD3Q.js";import"/build/_shared/chunk-PGURRWG5.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as rt}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as u,b as C,c as D,e as F,f as k}from"/build/_shared/chunk-G5A27C7O.js";import{h as c}from"/build/_shared/chunk-NVGVVEPD.js";import{Ea as H,X as I,b as L,oa as $,t as E}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as S,i as N,k as v,l as y,p as w,q as x}from"/build/_shared/chunk-GTSSQFHM.js";import{a as st,b as T}from"/build/_shared/chunk-BBTKOQ57.js";import{e as i}from"/build/_shared/chunk-UED2Q7CE.js";var n=i(st()),nt=i(mt());var lt=i(it()),dt=i(rt()),ct=i(ot());var t=i(T());function R(){let{users:U,hourGroup:m,can:V}=w(),b=x(),g=S(),[f,P]=(0,n.useState)(!1),[l,p]=(0,n.useState)(m.workTimes),[J,z]=(0,n.useState)(m.attachments),[_,K]=(0,n.useState)(!1),Q=()=>{let e=new Date,a=e.toISOString().split("T")[0],s=e.toISOString().split("T")[1].split(".")[0];p([...l,{date:a,startAt:s,endAt:s,restShouldStartAt:s,restShouldEndAt:s}])},X=e=>{p(l.filter((a,s)=>s!==e))},d=(e,a,s)=>{let h=[...l];h[e]={...h[e],[a]:s},p(h)},Y=N(),Z=e=>{e.preventDefault(),P(!0);let a=new FormData(e.currentTarget);J.forEach(s=>{a.append("attachments",s.id)}),Y(a,{method:"post"})},tt=e=>{z(e)},[A,et]=(0,n.useState)(m.members.map(e=>e.id)),at=e=>{et(a=>a.includes(e)?a.filter(s=>s!==e):[...a,e])};return(0,t.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:py-10",children:[V?.list&&(0,t.jsx)(c,{asChild:!0,variant:"outline",className:"mb-6 h-11 text-base",children:(0,t.jsxs)(v,{prefetch:"intent",to:"/o/hour-group",children:[(0,t.jsx)(L,{className:"mr-2 h-5 w-5"}),"Retour \xE0 la liste"]})}),(0,t.jsxs)(u,{className:"max-w-4xl mx-auto",children:[(0,t.jsx)(C,{className:"p-4 sm:p-6",children:(0,t.jsx)(D,{className:"text-xl sm:text-2xl lg:text-3xl font-bold",children:"Modifier Programmes"})}),(0,t.jsxs)(y,{method:"post",onSubmit:Z,children:[(0,t.jsxs)(F,{className:"p-4 sm:p-6 space-y-6",children:[b?.error&&(0,t.jsxs)(j,{variant:"destructive",children:[(0,t.jsx)(E,{className:"h-5 w-5"}),(0,t.jsx)(B,{className:"text-base font-medium",children:"Erreur"}),(0,t.jsx)(M,{className:"text-base",children:b.error})]}),(0,t.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,t.jsx)(r,{htmlFor:"note",className:"text-base font-medium",children:"Note"}),(0,t.jsx)(O,{id:"note",name:"note",defaultValue:m.note,className:"min-h-[120px] text-base p-3"})]}),(0,t.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,t.jsx)(r,{htmlFor:"startAt",className:"text-base font-medium",children:"Date de d\xE9but"}),(0,t.jsx)(o,{type:"date",id:"startAt",name:"startAt",defaultValue:new Date(m.startAt).toISOString().split("T")[0],required:!0,className:"h-11 text-base"})]}),(0,t.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,t.jsx)(r,{htmlFor:"endAt",className:"text-base font-medium",children:"Date de fin"}),(0,t.jsx)(o,{type:"date",id:"endAt",name:"endAt",defaultValue:new Date(m.endAt).toISOString().split("T")[0],required:!0,className:"h-11 text-base"})]}),(0,t.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,t.jsx)(r,{htmlFor:"restShouldStartAt",className:"text-base font-medium",children:"Heure de d\xE9but de pause par d\xE9faut"}),(0,t.jsx)(o,{type:"time",id:"restShouldStartAt",name:"restShouldStartAt",defaultValue:m.restShouldStartAt,className:"h-11 text-base"})]}),(0,t.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,t.jsx)(r,{htmlFor:"restShouldEndAt",className:"text-base font-medium",children:"Heure de fin de pause par d\xE9faut"}),(0,t.jsx)(o,{type:"time",id:"restShouldEndAt",name:"restShouldEndAt",defaultValue:m.restShouldEndAt,className:"h-11 text-base"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(r,{className:"text-base font-medium",children:"Horaires de travail"}),l.map((e,a)=>(0,t.jsx)(u,{className:"p-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(r,{htmlFor:`workTime-${a}-date`,className:"text-base font-medium",children:"Date"}),(0,t.jsx)(o,{type:"date",id:`workTime-${a}-date`,value:new Date(e.date).toISOString().split("T")[0],onChange:s=>d(a,"date",s.target.value),required:!0,className:"h-11 text-base"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(r,{htmlFor:`workTime-${a}-startAt`,className:"text-base font-medium",children:"D\xE9but"}),(0,t.jsx)(o,{type:"time",id:`workTime-${a}-startAt`,value:e.startAt,onChange:s=>d(a,"startAt",s.target.value),required:!0,className:"h-11 text-base"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(r,{htmlFor:`workTime-${a}-endAt`,className:"text-base font-medium",children:"Fin"}),(0,t.jsx)(o,{type:"time",id:`workTime-${a}-endAt`,value:e.endAt,onChange:s=>d(a,"endAt",s.target.value),required:!0,className:"h-11 text-base"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(r,{htmlFor:`workTime-${a}-restShouldStartAt`,className:"text-base font-medium",children:"D\xE9but pause"}),(0,t.jsx)(o,{type:"time",id:`workTime-${a}-restShouldStartAt`,value:e.restShouldStartAt,onChange:s=>d(a,"restShouldStartAt",s.target.value),className:"h-11 text-base"})]}),(0,t.jsxs)("div",{className:"flex items-end",children:[(0,t.jsxs)("div",{className:"flex-1 mr-2",children:[(0,t.jsx)(r,{htmlFor:`workTime-${a}-restShouldEndAt`,className:"text-base font-medium",children:"Fin pause"}),(0,t.jsx)(o,{type:"time",id:`workTime-${a}-restShouldEndAt`,value:e.restShouldEndAt,onChange:s=>d(a,"restShouldEndAt",s.target.value),className:"h-11 text-base"})]}),(0,t.jsx)(c,{type:"button",variant:"destructive",onClick:()=>X(a),className:"h-11 w-11",children:(0,t.jsx)(H,{className:"h-5 w-5"})})]})]})},a)),(0,t.jsxs)(c,{type:"button",onClick:Q,className:"w-full sm:w-auto h-11 text-base",children:[(0,t.jsx)($,{className:"mr-2 h-5 w-5"}),"Ajouter un horaire"]})]}),(0,t.jsx)("input",{type:"hidden",name:"workTimes",value:JSON.stringify(l)}),(0,t.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,t.jsx)(r,{className:"text-base font-medium",children:"Membres de l'\xE9quipe"}),(0,t.jsx)(u,{children:(0,t.jsx)(G,{className:"h-72 sm:h-80 w-full rounded-md border p-4",children:U.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-3 py-3 sm:py-4",children:[(0,t.jsx)(W,{id:`user-${e.id}`,checked:A.includes(e.id),onCheckedChange:()=>at(e.id),className:"h-5 w-5 sm:h-6 sm:w-6"}),(0,t.jsxs)("label",{htmlFor:`user-${e.id}`,className:"text-base font-medium cursor-pointer",children:[e.firstName," ",e.lastName]}),A.includes(e.id)&&(0,t.jsx)("input",{type:"hidden",name:"members",value:e.id})]},e.id))})})]}),(0,t.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,t.jsx)(r,{htmlFor:"attachments",className:"text-base font-medium",children:"Images & Pi\xE8ces jointes"}),(0,t.jsx)(q,{onSelect:tt,defaultSelectedDocuments:m.attachments,multiple:!0,accept:"image/*,application/pdf",maxSize:5*1024*1024,onBusyStateChange:K,className:"w-full"})]})]}),(0,t.jsx)(k,{className:"p-4 sm:p-6",children:(0,t.jsx)(c,{type:"submit",className:"w-full h-11 text-base",disabled:f||_||g.state==="submitting",children:f||g.state==="submitting"?(0,t.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,t.jsx)(I,{className:"h-5 w-5 animate-spin"}),"Mise \xE0 jour en cours..."]}):"Mettre \xE0 jour le groupe d'heures"})})]})]})]})}export{R as default};
