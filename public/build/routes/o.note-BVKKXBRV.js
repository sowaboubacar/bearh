import{a as A}from"/build/_shared/chunk-6QXFNV75.js";import{a as Pe}from"/build/_shared/chunk-CXU4QXE4.js";import{a as ne,b as de}from"/build/_shared/chunk-ABDDDOIB.js";import{a as oe,b as ce,c as me,d as y,e as c,f as m}from"/build/_shared/chunk-IEDNE26R.js";import{a as ue,b as pe,c as ge,d as he,e as b}from"/build/_shared/chunk-NCY4KUS2.js";import"/build/_shared/chunk-Q6K63OHD.js";import"/build/_shared/chunk-KAUQO2FD.js";import"/build/_shared/chunk-7ZNTUDLC.js";import{a as F}from"/build/_shared/chunk-OFTXZR4P.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as re}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-XNZ6DBKW.js";import"/build/_shared/chunk-YYMCCM4Y.js";import{a as Be}from"/build/_shared/chunk-35S5HMBT.js";import"/build/_shared/chunk-2BPW44Z6.js";import"/build/_shared/chunk-5KYGR3MA.js";import{a as D,b as T,d as S,e as L,f as B,g as P,h as k}from"/build/_shared/chunk-KLKNQD3Q.js";import"/build/_shared/chunk-PGURRWG5.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as Le}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as K,b as Q,c as X,e as Y,f as Z}from"/build/_shared/chunk-G5A27C7O.js";import{h as a}from"/build/_shared/chunk-NVGVVEPD.js";import{Ea as C,K as N,Oa as le,P as _,Q as ee,W as te,Y as ae,oa as se,ra as ie,xa as v}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as U,h as M,i as q,k as o,l as G,p as W,r as z}from"/build/_shared/chunk-GTSSQFHM.js";import{a as Se,b as J}from"/build/_shared/chunk-BBTKOQ57.js";import{e as n}from"/build/_shared/chunk-UED2Q7CE.js";var i=n(Se()),ke=n(Be());var Fe=n(Pe());var Ae=n(Le());var e=n(J());function be(){let{notes:r,search:fe,view:x,page:d,limit:w,visibility:xe,can:l}=W(),[f,R]=(0,i.useState)(!1),[H,u]=M(),Re=q(),p=z(),we=U().state==="loading",[g,Ne]=(0,i.useState)(x),[ve,Ce]=(0,i.useState)(!1),[I,h]=(0,i.useState)(null);(0,i.useEffect)(()=>{Ce(!0)},[]),(0,i.useEffect)(()=>{Ne(H.get("view")||x)},[H,x]);let V=t=>{R(!0),p.submit({id:t,action:"delete"},{method:"post"}),h(null)};(0,i.useEffect)(()=>{p.state==="idle"&&p.data?.success&&R(!1)},[p.state,p.data]);let ye=t=>{t.preventDefault();let Te=new FormData(t.currentTarget).get("search");u(O=>(O.set("search",Te),O))},E=t=>{u(s=>(s.set("view",t),s))},De=t=>{u(s=>(s.set("visibility",t),s))},$=t=>{switch(t){case"Private":return(0,e.jsx)(ae,{className:"h-5 w-5"});case"Public":return(0,e.jsx)(_,{className:"h-5 w-5"});case"Shared":return(0,e.jsx)(le,{className:"h-5 w-5"});default:return null}},j=t=>t&&`${t.firstName||""} ${t.lastName||""}`.trim()||"Unknown Author";return ve?(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 space-y-6",children:[(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,e.jsx)("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold",children:"Notes"}),l?.create&&(0,e.jsx)(a,{asChild:!0,className:"w-full sm:w-auto h-12 text-base",children:(0,e.jsxs)(o,{prefetch:"intent",to:"/o/note/new",children:[(0,e.jsx)(se,{className:"mr-2 h-5 w-5"}),"Nouvelle Note"]})})]}),(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-4",children:[(0,e.jsxs)(G,{onSubmit:ye,className:"flex items-center gap-2 w-full sm:w-auto sm:flex-1",children:[(0,e.jsx)(re,{type:"search",name:"search",placeholder:"Rechercher des notes...",defaultValue:fe,className:"h-12 text-base"}),(0,e.jsx)(a,{type:"submit",className:"h-12 w-12 flex-shrink-0",children:(0,e.jsx)(ie,{className:"h-5 w-5"})})]}),(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[(0,e.jsxs)(ue,{value:xe,onValueChange:De,children:[(0,e.jsx)(ge,{className:"h-12 text-base w-full sm:w-[200px]",children:(0,e.jsx)(pe,{placeholder:"Filtrer par visibilit\xE9"})}),(0,e.jsxs)(he,{children:[(0,e.jsx)(b,{value:"all",className:"text-base",children:"Toutes"}),(0,e.jsx)(b,{value:"Private",className:"text-base",children:"Priv\xE9es"}),(0,e.jsx)(b,{value:"Public",className:"text-base",children:"Publiques"}),(0,e.jsx)(b,{value:"Shared",className:"text-base",children:"Partag\xE9es"})]})]}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)(a,{variant:g==="grid"?"default":"outline",onClick:()=>E("grid"),className:"flex-1 sm:flex-none h-12",children:(0,e.jsx)(ee,{className:"h-5 w-5"})}),(0,e.jsx)(a,{variant:g==="list"?"default":"outline",onClick:()=>E("list"),className:"flex-1 sm:flex-none h-12",children:(0,e.jsx)(te,{className:"h-5 w-5"})})]})]})]}),we?(0,e.jsx)(de,{view:g,itemCount:w}):r.results.length>0?g==="grid"?(0,e.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:r.results.map(t=>(0,e.jsxs)(K,{children:[(0,e.jsxs)(Q,{className:"p-4 sm:p-6",children:[(0,e.jsxs)(X,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[(0,e.jsx)("span",{className:"text-lg font-bold",children:t.title}),(0,e.jsxs)(F,{variant:t.visibility==="Private"?"secondary":t.visibility==="Public"?"default":"outline",className:"h-8 text-base px-3 py-1",children:[$(t.visibility),(0,e.jsx)("span",{className:"ml-2",children:t.visibility})]})]}),(0,e.jsx)("div",{className:"aspect-video rounded-lg overflow-hidden",children:(0,e.jsx)("img",{src:A(t.attachments)?.file?.url,alt:A(t.attachments)?.label||"",className:"w-full h-full object-cover"})})]}),(0,e.jsxs)(Y,{className:"p-4 sm:p-6 pt-0 space-y-3",children:[(0,e.jsx)("p",{className:"text-base text-muted-foreground line-clamp-2",children:t.content}),(0,e.jsxs)("p",{className:"text-base text-muted-foreground",children:["Auteur : ",j(t.author)]}),(0,e.jsxs)("p",{className:"text-base text-muted-foreground",children:["Cr\xE9\xE9e le : ",new Date(t.createdAt).toLocaleString()]})]}),(0,e.jsxs)(Z,{className:"p-4 sm:p-6 flex justify-between gap-3",children:[l?.view&&(0,e.jsx)(a,{asChild:!0,variant:"outline",className:"flex-1 h-12 text-base",children:(0,e.jsx)(o,{prefetch:"intent",to:`/o/note/view/${t.id}`,children:(0,e.jsx)(N,{className:"mr-2 h-5 w-5"})})}),l?.edit&&(0,e.jsx)(a,{asChild:!0,variant:"outline",className:"flex-1 h-12 text-base",children:(0,e.jsx)(o,{prefetch:"intent",to:`/o/note/edit/${t.id}`,children:(0,e.jsx)(v,{className:"mr-2 h-5 w-5"})})}),l?.delete&&(0,e.jsxs)(D,{open:I===t.id,onOpenChange:s=>h(s?t.id:null),children:[(0,e.jsx)(T,{asChild:!0,children:(0,e.jsx)(a,{variant:"destructive",className:"flex-1 h-12 text-base",children:(0,e.jsx)(C,{className:"mr-2 h-5 w-5"})})}),(0,e.jsxs)(S,{className:"sm:max-w-[425px]",children:[(0,e.jsxs)(L,{children:[(0,e.jsx)(P,{className:"text-xl",children:"\xCAtes-vous s\xFBr de vouloir supprimer cette note ?"}),(0,e.jsx)(k,{className:"text-base",children:"Cette action ne peut pas \xEAtre annul\xE9e."})]}),(0,e.jsxs)(B,{className:"gap-3 sm:gap-0",children:[(0,e.jsx)(a,{variant:"outline",onClick:()=>h(null),className:"h-12 text-base",children:"Annuler"}),(0,e.jsx)(a,{variant:"destructive",onClick:()=>V(t.id),disabled:f,className:"h-12 text-base",children:f?"Suppression...":"Supprimer"})]})]})]})]})]},t.id))}):(0,e.jsx)("div",{className:"rounded-lg border overflow-x-auto",children:(0,e.jsxs)(oe,{children:[(0,e.jsx)(ce,{children:(0,e.jsxs)(y,{children:[(0,e.jsx)(c,{className:"text-base whitespace-nowrap",children:"Titre"}),(0,e.jsx)(c,{className:"text-base whitespace-nowrap hidden sm:table-cell",children:"Auteur"}),(0,e.jsx)(c,{className:"text-base whitespace-nowrap",children:"Visibilit\xE9"}),(0,e.jsx)(c,{className:"text-base whitespace-nowrap hidden md:table-cell",children:"Date de cr\xE9ation"}),(0,e.jsx)(c,{className:"text-base text-right",children:"Actions"})]})}),(0,e.jsx)(me,{children:r.results.map(t=>(0,e.jsxs)(y,{children:[(0,e.jsx)(m,{className:"font-medium text-base",children:t.title}),(0,e.jsx)(m,{className:"text-base hidden sm:table-cell",children:j(t.author)}),(0,e.jsx)(m,{children:(0,e.jsxs)(F,{variant:t.visibility==="Private"?"secondary":t.visibility==="Public"?"default":"outline",className:"h-8 text-base px-3 py-1",children:[$(t.visibility),(0,e.jsx)("span",{className:"ml-2",children:t.visibility})]})}),(0,e.jsx)(m,{className:"text-base hidden md:table-cell",children:new Date(t.createdAt).toLocaleString()}),(0,e.jsx)(m,{children:(0,e.jsxs)("div",{className:"flex justify-end gap-2",children:[l?.view&&(0,e.jsx)(a,{asChild:!0,variant:"outline",className:"h-12 text-base px-3",children:(0,e.jsx)(o,{prefetch:"intent",to:`/o/note/view/${t.id}`,children:(0,e.jsx)(N,{className:"h-5 w-5"})})}),l?.edit&&(0,e.jsx)(a,{asChild:!0,variant:"outline",className:"h-12 text-base px-3",children:(0,e.jsx)(o,{prefetch:"intent",to:`/o/note/edit/${t.id}`,children:(0,e.jsx)(v,{className:"h-5 w-5"})})}),l?.delete&&(0,e.jsxs)(D,{open:I===t.id,onOpenChange:s=>h(s?t.id:null),children:[(0,e.jsx)(T,{asChild:!0,children:(0,e.jsx)(a,{variant:"destructive",className:"h-12 text-base px-3",children:(0,e.jsx)(C,{className:"h-5 w-5"})})}),(0,e.jsxs)(S,{className:"sm:max-w-[425px]",children:[(0,e.jsxs)(L,{children:[(0,e.jsx)(P,{className:"text-xl",children:"\xCAtes-vous s\xFBr de vouloir supprimer cette note ?"}),(0,e.jsx)(k,{className:"text-base",children:"Cette action ne peut pas \xEAtre annul\xE9e."})]}),(0,e.jsxs)(B,{className:"gap-3 sm:gap-0",children:[(0,e.jsx)(a,{variant:"outline",onClick:()=>h(null),className:"h-12 text-base",children:"Annuler"}),(0,e.jsx)(a,{variant:"destructive",onClick:()=>V(t.id),disabled:f,className:"h-12 text-base",children:f?"Suppression...":"Supprimer"})]})]})]})]})})]},t.id))})]})}):(0,e.jsx)(ne,{type:"notes",createLink:"/o/note/new",view:g}),r.totalResults>0&&(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4",children:[(0,e.jsx)(a,{onClick:()=>u(t=>(t.set("page",(d-1).toString()),t)),disabled:d===1,className:"w-full sm:w-auto h-12 text-base",children:"Pr\xE9c\xE9dent"}),(0,e.jsxs)("span",{className:"text-base",children:["Page ",d," sur ",Math.ceil(r.totalResults/w)]}),(0,e.jsx)(a,{onClick:()=>u(t=>(t.set("page",(d+1).toString()),t)),disabled:d*w>=r.totalResults,className:"w-full sm:w-auto h-12 text-base",children:"Suivant"})]})]}):null}export{be as default};
