import{a as Ce}from"/build/_shared/chunk-NX6ZEDKE.js";import{a as ie}from"/build/_shared/chunk-XDNDK56N.js";import{a as k,b as D,c as A}from"/build/_shared/chunk-MRGZKXS3.js";import{b as m}from"/build/_shared/chunk-FB4U2LCE.js";import"/build/_shared/chunk-KAUQO2FD.js";import"/build/_shared/chunk-7ZNTUDLC.js";import{a as Ae}from"/build/_shared/chunk-6JFOYO3V.js";import{a as L}from"/build/_shared/chunk-OFTXZR4P.js";import{a as re}from"/build/_shared/chunk-H33OI7YH.js";import{b as ae}from"/build/_shared/chunk-SS7AQOQ3.js";import{a as E,b as F,c as S}from"/build/_shared/chunk-2MHSPA7K.js";import{a as C}from"/build/_shared/chunk-WZRQ3RQI.js";import{a as M,d as I,e as P,g as B}from"/build/_shared/chunk-KLKNQD3Q.js";import"/build/_shared/chunk-PGURRWG5.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import{a as De}from"/build/_shared/chunk-B6OA2ZRE.js";import{h as r}from"/build/_shared/chunk-NVGVVEPD.js";import{E as N,Ja as te,Ka as se,S as Q,b as Y,ba as X,ea as Z,q as _,r as J,ra as ee,w as K}from"/build/_shared/chunk-PNJDYZ5P.js";import{k as q,p as G,r as U}from"/build/_shared/chunk-GTSSQFHM.js";import{a as ke,b as W}from"/build/_shared/chunk-BBTKOQ57.js";import{e as l}from"/build/_shared/chunk-UED2Q7CE.js";var s=l(ke());var Ee=l(Ce()),Fe=l(Ae()),Se=l(De());var e=l(W()),Me=()=>[{rel:"preload",as:"image",href:"https://images.unsplash.com/photo-1562243061-204550d8a2c9?q=80&w=1887&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"}],T=12;function oe(){let n=G(),i=U(),{toast:ne}=re(),[p,le]=(0,s.useState)(new Date),[a,O]=(0,s.useState)(null),[u,x]=(0,s.useState)(""),[h,ce]=(0,s.useState)(""),[me,g]=(0,s.useState)(!1),[xe,b]=(0,s.useState)(!1),[de,pe]=(0,s.useState)(""),[c,V]=(0,s.useState)(1),[f,v]=(0,s.useState)(null),[ue,he]=(0,s.useState)(!0),[ge,j]=(0,s.useState)(n.employees||[]),[z,H]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let t=setInterval(()=>le(new Date),1e3);return()=>clearInterval(t)},[]),(0,s.useEffect)(()=>{n&&!n.error&&(he(!1),j(n.employees||[]))},[n]);let be=()=>{document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),H(!1)):(document.documentElement.requestFullscreen(),H(!0))},fe=t=>{O(t),x(""),g(!0)},d=t=>{if(u?.length!==4){ne({title:"Code PIN invalide",description:"Veuillez entrer un code PIN \xE0 4 chiffres.",variant:"destructive"});return}let o;switch(t){case"Arriv\xE9e":o="checkIn";break;case"D\xE9part":o="checkOut";break;case"D\xE9but de pause":o="breakStart";break;case"Fin de pause":o="breakEnd";break}i.submit({userId:a.id,pin:u,actionType:o},{method:"post"})},ve=()=>{g(!1),v(null),x("")};if((0,s.useEffect)(()=>{if(i.data&&i.data.success){let{record:t,user:o,actionType:ye}=i.data,$=[`Pointage re\xE7u ! Vous ${{checkIn:"\xEAtes arriv\xE9(e)",checkOut:"\xEAtes parti(e)",breakStart:"avez commenc\xE9 votre pause",breakEnd:"avez termin\xE9 votre pause"}[ye]||""} \xE0 ${p.toLocaleTimeString()}.`,"Merci pour votre ponctualit\xE9 ! Votre action a \xE9t\xE9 enregistr\xE9e.","Bonne journ\xE9e ! Votre action est bien not\xE9e.","Excellent ! Votre pr\xE9sence est importante pour nous."];pe($[Math.floor(Math.random()*$.length)]),g(!1),b(!0),O(null),x(""),j(Ne=>Ne.map(y=>y.id===o.id?{...y,status:o.status}:y))}else i.data&&!i.data.success&&v(i.data.message)},[i.data]),ue)return(0,e.jsx)("div",{className:"flex justify-center items-center h-screen bg-pharmacy-background bg-cover bg-center",children:(0,e.jsx)(m.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5},className:"text-3xl font-bold text-white bg-black bg-opacity-50 p-4 rounded-lg",children:"Chargement..."})});if(n.error)return(0,e.jsxs)(E,{variant:"destructive",children:[(0,e.jsx)(F,{children:"Erreur"}),(0,e.jsx)(S,{children:n.error})]});let R=ge.filter(t=>t.firstName.toLowerCase().includes(h.toLowerCase())||t.lastName.toLowerCase().includes(h.toLowerCase())),w=Math.ceil(R.length/T),we=R.slice((c-1)*T,c*T);return(0,e.jsx)("div",{className:"min-h-screen w-full overflow-x-scroll  bg-[url('https://images.unsplash.com/photo-1562243061-204550d8a2c9?q=80&w=1887&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D')] bg-cover bg-center",children:(0,e.jsx)("div",{className:"min-h-screen w-full bg-primary/50 backdrop-blur-sm",children:(0,e.jsxs)("div",{className:"mx-auto w-full max-w-7xl px-3 py-4 xs:px-4 sm:px-6 lg:px-8 sm:py-6 lg:py-8",children:[(0,e.jsxs)("header",{className:"mb-4 flex flex-col xs:flex-row justify-between items-center gap-3 bg-white/80 p-3 xs:p-4 rounded-lg backdrop-blur-sm sm:mb-6 lg:mb-8",children:[(0,e.jsx)("h1",{className:"text-xl xs:text-2xl sm:text-3xl lg:text-4xl font-bold text-primary",children:"Pointage"}),(0,e.jsxs)(q,{to:"/login",className:"inline-flex items-center text-xs xs:text-sm text-primary hover:text-primary-dark transition-colors",children:[(0,e.jsx)(Y,{className:"mr-1.5 h-3 w-3 xs:h-4 xs:w-4"}),"Acc\xE9der \xE0 l'espace personnel"]})]}),(0,e.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm rounded-lg p-3 xs:p-4 sm:p-5 lg:p-6 mb-6 sm:mb-8",children:[(0,e.jsxs)("div",{className:"flex items-center justify-center mb-3 sm:mb-4",children:[(0,e.jsx)(Q,{className:"h-4 w-4 xs:h-5 xs:w-5 mr-2 text-primary"}),(0,e.jsx)("p",{className:"text-center text-sm xs:text-base sm:text-lg text-primary-dark",children:"Veuillez simplement cliquer sur votre avatar pour pointer."})]}),(0,e.jsxs)("div",{className:"relative mb-4 sm:mb-6",children:[(0,e.jsx)(C,{type:"text",placeholder:"Rechercher un employ\xE9...",value:h,onChange:t=>ce(t.target.value),className:"pl-9 xs:pl-10 pr-4 py-2 h-9 xs:h-10 text-xs xs:text-sm w-full bg-white/50 backdrop-blur-sm focus:bg-white transition-all"}),(0,e.jsx)(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 xs:h-5 xs:w-5 text-primary"})]}),(0,e.jsx)(ie,{className:"",children:(0,e.jsx)(m.div,{initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2 xs:gap-3 sm:gap-4",children:we.map(t=>(0,e.jsx)(m.div,{variants:{hidden:{y:20,opacity:0},visible:{y:0,opacity:1}},children:(0,e.jsxs)(r,{variant:"outline",className:"w-full h-auto p-2 xs:p-3 sm:p-4 flex flex-col items-center space-y-1.5 xs:space-y-2 hover:bg-primary-50 transition-colors rounded-lg shadow-md hover:shadow-lg bg-white/90",onClick:()=>fe(t),children:[(0,e.jsxs)(k,{className:"w-14 h-14 xs:w-16 xs:h-16 sm:w-20 sm:h-20 border-2 border-primary",children:[(0,e.jsx)(D,{src:t.avatar?.file?.url,alt:`${t.firstName} ${t.lastName}`}),(0,e.jsxs)(A,{className:"text-lg xs:text-xl sm:text-2xl bg-primary-100 text-primary-700",children:[t.firstName[0],t.lastName[0]]})]}),(0,e.jsxs)("span",{className:"text-xs xs:text-sm font-semibold text-center text-primary-800",children:[t.firstName," ",t.lastName]}),t.position&&(0,e.jsx)(L,{variant:"secondary",className:"mt-0.5 xs:mt-1 text-[10px] xs:text-xs bg-primary-100 text-primary-700",children:t.position}),(0,e.jsx)(L,{variant:t.status==="present"?"success":t.status==="absent"?"destructive":t.status==="onBreak"?"warning":"default",className:"mt-0.5 xs:mt-1 text-[10px] xs:text-xs",children:t.status})]})},t.id))})}),(0,e.jsxs)("div",{className:"flex justify-between items-center mt-4 sm:mt-6",children:[(0,e.jsxs)(r,{onClick:()=>V(t=>Math.max(t-1,1)),disabled:c===1,variant:"outline",size:"sm",className:"h-8 xs:h-9 text-xs xs:text-sm bg-white hover:bg-primary-50",children:[(0,e.jsx)(_,{className:"h-3 w-3 xs:h-4 xs:w-4 mr-1.5 xs:mr-2"}),"Pr\xE9c\xE9dent"]}),(0,e.jsxs)("span",{className:"text-xs xs:text-sm text-primary-700",children:["Page ",c," sur ",w]}),(0,e.jsxs)(r,{onClick:()=>V(t=>Math.min(t+1,w)),disabled:c===w,variant:"outline",size:"sm",className:"h-8 xs:h-9 text-xs xs:text-sm bg-white hover:bg-primary-50",children:["Suivant",(0,e.jsx)(J,{className:"h-3 w-3 xs:h-4 xs:w-4 ml-1.5 xs:ml-2"})]})]})]}),(0,e.jsx)(M,{open:me,onOpenChange:ve,children:(0,e.jsxs)(I,{className:"w-[calc(100%-24px)] xs:w-[425px] max-w-[425px] p-4 xs:p-6 bg-white/95 backdrop-blur-md",children:[(0,e.jsx)(P,{children:(0,e.jsx)(B,{className:"text-xl xs:text-2xl font-bold text-center text-primary-700",children:"Pointage"})}),(0,e.jsxs)("div",{className:"space-y-4 xs:space-y-6",children:[(0,e.jsx)("div",{className:"text-center",children:(0,e.jsx)("time",{className:"text-sm xs:text-base font-semibold text-primary-700",dateTime:p.toISOString(),children:p.toLocaleTimeString()})}),a&&(0,e.jsxs)("div",{className:"space-y-4 xs:space-y-6",children:[(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsxs)(k,{className:"w-24 h-24 xs:w-32 xs:h-32 mx-auto border-4 border-primary",children:[(0,e.jsx)(D,{src:a.avatar?.file?.url,alt:`${a.firstName} ${a.lastName}`}),(0,e.jsxs)(A,{className:"text-2xl xs:text-4xl bg-primary-100 text-primary-700",children:[a.firstName[0],a.lastName[0]]})]}),(0,e.jsxs)("h2",{className:"mt-3 xs:mt-4 text-xs xs:text-sm font-semibold text-primary-800",children:[a.firstName," ",a.lastName]}),a.position&&(0,e.jsx)("p",{className:"text-xs xs:text-sm text-primary-600",children:a.position})]}),(0,e.jsxs)("div",{className:"space-y-3 xs:space-y-4",children:[(0,e.jsx)(ae,{htmlFor:"pin",className:"text-xs xs:text-sm font-bold text-primary-700",children:"Entrez votre code PIN"}),f&&(0,e.jsxs)(E,{variant:"destructive",children:[(0,e.jsx)(F,{className:"text-xs xs:text-sm",children:"Erreur"}),(0,e.jsx)(S,{className:"text-xs xs:text-sm",children:f})]}),(0,e.jsx)(C,{id:"pin",type:"password",placeholder:"****",value:u,onChange:t=>{x(t.target.value),v(null)},maxLength:4,className:`text-center text-xl xs:text-2xl h-12 ${f?"shake":""}`})]}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-2 xs:gap-4",children:[(0,e.jsxs)(r,{onClick:()=>d("Arriv\xE9e"),className:"h-14 xs:h-16 text-base xs:text-lg bg-primary hover:bg-primary-dark text-white",children:[(0,e.jsx)(te,{className:"w-5 h-5 xs:w-6 xs:h-6 mr-1.5 xs:mr-2"}),"Arriv\xE9e"]}),(0,e.jsxs)(r,{onClick:()=>d("D\xE9part"),className:"h-14 xs:h-16 text-base xs:text-lg bg-red-500 hover:bg-red-600 text-white",children:[(0,e.jsx)(se,{className:"w-5 h-5 xs:w-6 xs:h-6 mr-1.5 xs:mr-2"}),"D\xE9part"]}),(0,e.jsxs)(r,{onClick:()=>d("D\xE9but de pause"),className:"h-14 xs:h-16 text-base xs:text-lg bg-yellow-500 hover:bg-yellow-600 text-white",children:[(0,e.jsx)(N,{className:"w-5 h-5 xs:w-6 xs:h-6 mr-1.5 xs:mr-2"}),"D\xE9but de pause"]}),(0,e.jsxs)(r,{onClick:()=>d("Fin de pause"),className:"h-14 xs:h-16 text-base xs:text-lg bg-blue-500 hover:bg-blue-600 text-white",children:[(0,e.jsx)(N,{className:"w-5 h-5 xs:w-6 xs:h-6 mr-1.5 xs:mr-2"}),"Fin de pause"]})]})]})]})]})}),(0,e.jsx)(M,{open:xe,onOpenChange:b,children:(0,e.jsxs)(I,{className:"w-[calc(100%-24px)] xs:w-[425px] max-w-[425px] p-4 xs:p-6 bg-white/95 backdrop-blur-md",children:[(0,e.jsx)(P,{children:(0,e.jsx)(B,{className:"text-xl xs:text-2xl font-bold text-center text-primary-600",children:"Pointage R\xE9ussi"})}),(0,e.jsxs)("div",{className:"text-center space-y-4 xs:space-y-6",children:[(0,e.jsx)(m.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},children:(0,e.jsx)(K,{className:"w-20 h-20 xs:w-24 xs:h-24 mx-auto text-primary"})}),(0,e.jsx)("p",{className:"text-lg xs:text-xl text-primary-700",children:de}),(0,e.jsx)(r,{onClick:()=>b(!1),className:"w-full h-10 xs:h-12 text-base xs:text-lg bg-primary hover:bg-primary-dark text-white",children:"Fermer"})]})]})}),(0,e.jsx)(r,{onClick:be,className:"fixed top-4 right-4 z-50 rounded-full w-12 h-12 bg-secondary hover:bg-primary-dark text-dark shadow-lg",title:z?"Exit Fullscreen":"Enter Fullscreen",children:z?(0,e.jsx)(Z,{className:"h-6 w-6"}):(0,e.jsx)(X,{className:"h-6 w-6"})})]})})})}export{oe as default,Me as links};
