import{a as f,b as j}from"/build/_shared/chunk-LMEZILER.js";import{a as v}from"/build/_shared/chunk-YDVZI2RP.js";import{b as n}from"/build/_shared/chunk-SS7AQOQ3.js";import{a as r}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-OMO5CWS2.js";import{a as m,b as u,c as p,e as g}from"/build/_shared/chunk-G5A27C7O.js";import{h as d}from"/build/_shared/chunk-NVGVVEPD.js";import{Ea as D,X as b,b as C,oa as h,qa as R}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as A,k as y,p as B}from"/build/_shared/chunk-GTSSQFHM.js";import{a as q,b as T}from"/build/_shared/chunk-BBTKOQ57.js";import{e as N}from"/build/_shared/chunk-UED2Q7CE.js";var x=N(q());var a=N(T());function z(){let{payslipData:I}=B(),[w,L]=(0,x.useState)(!1),[t,l]=(0,x.useState)(I);if(A().state==="loading")return(0,a.jsx)("div",{className:"container mx-auto py-10 flex items-center justify-center",children:(0,a.jsx)(b,{className:"h-8 w-8 animate-spin"})});if(!t)return(0,a.jsx)("div",{className:"container mx-auto py-10",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-muted-foreground",children:"Impossible de charger la fiche de paie"}),(0,a.jsx)(y,{to:"/o/payroll",children:(0,a.jsx)(d,{variant:"link",className:"mt-4",children:"Retour \xE0 la liste"})})]})});let H=()=>{l(e=>e&&{...e,earnings:[...e.earnings,{id:Date.now().toString(),description:"",amount:0}]})},M=e=>{l(i=>i&&{...i,earnings:i.earnings.filter(s=>s.id!==e)})},P=(e,i,s)=>{l(o=>o&&{...o,earnings:o.earnings.map(c=>c.id===e?{...c,[i]:s}:c)})},$=()=>{l(e=>e&&{...e,deductions:[...e.deductions,{id:Date.now().toString(),description:"",amount:0}]})},J=e=>{l(i=>i&&{...i,deductions:i.deductions.filter(s=>s.id!==e)})},k=(e,i,s)=>{l(o=>o&&{...o,deductions:o.deductions.map(c=>c.id===e?{...c,[i]:s}:c)})},V=async()=>{try{L(!0),await new Promise(s=>setTimeout(s,1e3));let e=t.earnings.some(s=>!s.description||s.amount<=0),i=t.deductions.some(s=>!s.description||s.amount<=0);if(e||i){f.warning("Attention: Certains champs sont vides ou invalides");return}f.success("Fiche de paie mise \xE0 jour avec succ\xE8s",{description:`Net \xE0 payer: ${S.toLocaleString("fr-FR")} F CFA`})}catch{f.error("Erreur lors de la mise \xE0 jour",{description:"Veuillez r\xE9essayer plus tard"})}finally{L(!1)}},F=t.earnings.reduce((e,i)=>e+i.amount,0),E=t.deductions.reduce((e,i)=>e+i.amount,0),S=F-E;return(0,a.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 max-w-6xl",children:[(0,a.jsx)(d,{asChild:!0,variant:"outline",className:"mb-6 h-12 text-base",children:(0,a.jsxs)(y,{prefetch:"intent",to:"/o/payroll",children:[(0,a.jsx)(C,{className:"mr-2 h-5 w-5"}),"Retour \xE0 la liste"]})}),(0,a.jsxs)("div",{className:"container mx-auto py-10 space-y-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(y,{to:"/o/payroll",children:(0,a.jsx)(d,{variant:"ghost",size:"icon",children:(0,a.jsx)(C,{className:"h-4 w-4"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Modifier la Fiche de Paie"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:[t.employeeData.name," - ",t.payPeriod.month," ",t.payPeriod.year]})]})]}),(0,a.jsxs)(d,{onClick:V,disabled:w,children:[w?(0,a.jsx)(b,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(R,{className:"mr-2 h-4 w-4"}),"Enregistrer les modifications"]})]}),(0,a.jsxs)("div",{className:"grid gap-8",children:[(0,a.jsxs)(m,{children:[(0,a.jsx)(u,{children:(0,a.jsx)(p,{children:"Informations de Base"})}),(0,a.jsxs)(g,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"Employ\xE9"}),(0,a.jsx)(r,{value:t.employeeData.name,disabled:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"ID Employ\xE9"}),(0,a.jsx)(r,{value:t.employeeData.id,disabled:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"Poste"}),(0,a.jsx)(r,{value:t.employeeData.position,disabled:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"D\xE9partement"}),(0,a.jsx)(r,{value:t.employeeData.department,disabled:!0})]})]}),(0,a.jsx)(v,{}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"P\xE9riode"}),(0,a.jsx)(r,{value:`${t.payPeriod.month} ${t.payPeriod.year}`,disabled:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"Jours travaill\xE9s"}),(0,a.jsx)(r,{type:"number",value:t.payPeriod.workedDays,onChange:e=>{l(i=>i&&{...i,payPeriod:{...i.payPeriod,workedDays:parseInt(e.target.value)}})}})]})]})]})]}),(0,a.jsxs)(m,{children:[(0,a.jsxs)(u,{className:"flex flex-row items-center justify-between",children:[(0,a.jsx)(p,{children:"Revenus"}),(0,a.jsxs)(d,{onClick:H,variant:"outline",size:"sm",children:[(0,a.jsx)(h,{className:"h-4 w-4 mr-2"}),"Ajouter un revenu"]})]}),(0,a.jsx)(g,{className:"space-y-6",children:t.earnings.map(e=>(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(v,{}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"Description"}),(0,a.jsx)(r,{value:e.description,onChange:i=>P(e.id,"description",i.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"Montant (F CFA)"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r,{type:"number",value:e.amount,onChange:i=>P(e.id,"amount",parseFloat(i.target.value))}),(0,a.jsx)(d,{variant:"ghost",size:"icon",onClick:()=>M(e.id),children:(0,a.jsx)(D,{className:"h-4 w-4 text-destructive"})})]})]})]})]},e.id))})]}),(0,a.jsxs)(m,{children:[(0,a.jsxs)(u,{className:"flex flex-row items-center justify-between",children:[(0,a.jsx)(p,{children:"D\xE9ductions"}),(0,a.jsxs)(d,{onClick:$,variant:"outline",size:"sm",children:[(0,a.jsx)(h,{className:"h-4 w-4 mr-2"}),"Ajouter une d\xE9duction"]})]}),(0,a.jsx)(g,{className:"space-y-6",children:t.deductions.map(e=>(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(v,{}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"Description"}),(0,a.jsx)(r,{value:e.description,onChange:i=>k(e.id,"description",i.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"Montant (F CFA)"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r,{type:"number",value:e.amount,onChange:i=>k(e.id,"amount",parseFloat(i.target.value))}),(0,a.jsx)(d,{variant:"ghost",size:"icon",onClick:()=>J(e.id),children:(0,a.jsx)(D,{className:"h-4 w-4 text-destructive"})})]})]})]})]},e.id))})]}),(0,a.jsxs)(m,{children:[(0,a.jsx)(u,{children:(0,a.jsx)(p,{children:"R\xE9sum\xE9"})}),(0,a.jsxs)(g,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"Total Revenus"}),(0,a.jsx)(r,{value:F.toLocaleString("fr-FR"),disabled:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"Total D\xE9ductions"}),(0,a.jsx)(r,{value:E.toLocaleString("fr-FR"),disabled:!0})]})]}),(0,a.jsx)(v,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n,{children:"Net \xE0 Payer"}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[S.toLocaleString("fr-FR")," F CFA"]})]})]})]})]}),(0,a.jsx)(j,{position:"top-right",richColors:!0})]})]})}export{z as default};
