import{a as Y}from"/build/_shared/chunk-CXU4QXE4.js";import{a as R,b as U}from"/build/_shared/chunk-ABDDDOIB.js";import{a as L}from"/build/_shared/chunk-LZOQ52E6.js";import"/build/_shared/chunk-MRGZKXS3.js";import{a as A,b as B,c as F,d as p,e as r,f as i}from"/build/_shared/chunk-IEDNE26R.js";import{b as m}from"/build/_shared/chunk-FB4U2LCE.js";import{a as X}from"/build/_shared/chunk-6JFOYO3V.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as H}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as W}from"/build/_shared/chunk-B6OA2ZRE.js";import"/build/_shared/chunk-G5A27C7O.js";import{h as c}from"/build/_shared/chunk-NVGVVEPD.js";import{K as D,Oa as k,P,Y as S,ra as C}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as g,h as w,k as x,l as y,p as v,r as N}from"/build/_shared/chunk-GTSSQFHM.js";import{a as Q,b as T}from"/build/_shared/chunk-BBTKOQ57.js";import{e as s}from"/build/_shared/chunk-UED2Q7CE.js";var Z=s(W()),a=s(Q());var _=s(X()),ee=s(Y());var e=s(T());function $(){let{notes:o,search:E,page:n,limit:d,user:I,can:h}=v(),[te,f]=(0,a.useState)(!1),[ae,u]=w(),l=N(),V=g(),[j,M]=(0,a.useState)(!1),[se,O]=(0,a.useState)(null);(0,a.useEffect)(()=>{M(!0)},[]);let re=t=>{f(!0),l.submit({id:t,action:"delete"},{method:"post",action:"/o/notes"}),O(null)};(0,a.useEffect)(()=>{l.state==="idle"&&l.data?.success&&f(!1)},[l.state,l.data]);let G=t=>{t.preventDefault();let K=new FormData(t.currentTarget).get("search");u(b=>(b.set("search",K),b))},q=t=>{switch(t){case"Private":return(0,e.jsx)(S,{className:"h-5 w-5"});case"Public":return(0,e.jsx)(P,{className:"h-5 w-5"});case"Shared":return(0,e.jsx)(k,{className:"h-5 w-5"});default:return null}},z=t=>t&&`${t.firstName||""} ${t.lastName||""}`.trim()||"Unknown Author";if(!j)return null;let J=V.state==="loading";return(0,e.jsxs)(m.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"container mx-auto p-4 space-y-6 max-w-8xl",children:[(0,e.jsxs)(m.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},className:"mb-6",children:[(0,e.jsx)(L,{user:I,can:h}),(0,e.jsx)("h1",{className:"text-3xl font-bold mt-4 text-center",children:"Prise de notes Partag\xE9es"})]}),(0,e.jsx)(m.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 space-y-6",children:[(0,e.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-4",children:(0,e.jsxs)(y,{onSubmit:G,className:"flex items-center gap-2 w-full sm:w-auto sm:flex-1  rounded-full border-2 border-primary",children:[(0,e.jsx)(H,{type:"search",name:"search",placeholder:"Rechercher des notes...",defaultValue:E,className:"h-12 text-base"}),(0,e.jsx)(c,{type:"submit",className:"h-12 w-12 flex-shrink-0  rounded-full border-2 border-primary",children:(0,e.jsx)(C,{className:"h-5 w-5"})})]})}),J?(0,e.jsx)(U,{view:"list",itemCount:d}):o.results.length>0?(0,e.jsx)("div",{className:"rounded-lg border overflow-x-auto",children:(0,e.jsxs)(A,{children:[(0,e.jsx)(B,{children:(0,e.jsxs)(p,{children:[(0,e.jsx)(r,{className:"text-base whitespace-nowrap",children:"Titre"}),(0,e.jsx)(r,{className:"text-base whitespace-nowrap hidden sm:table-cell",children:"Auteur"}),(0,e.jsx)(r,{className:"text-base whitespace-nowrap",children:"Visibilit\xE9"}),(0,e.jsx)(r,{className:"text-base whitespace-nowrap hidden md:table-cell",children:"Date de cr\xE9ation"}),(0,e.jsx)(r,{className:"text-base text-right",children:"Actions"})]})}),(0,e.jsx)(F,{children:o.results.map(t=>(0,e.jsxs)(p,{children:[(0,e.jsx)(i,{className:"font-medium text-base",children:t.title}),(0,e.jsx)(i,{className:"text-base hidden sm:table-cell",children:z(t.author)}),(0,e.jsx)(i,{children:(0,e.jsxs)("div",{className:"h-8 text-base px-3 py-1 flex",children:[q(t.visibility),(0,e.jsx)("span",{className:"ml-2",children:t.visibility})]})}),(0,e.jsx)(i,{className:"text-base hidden md:table-cell",children:new Date(t.createdAt).toLocaleString()}),(0,e.jsx)(i,{children:(0,e.jsx)("div",{className:"flex justify-end gap-2",children:h?.note?.view&&(0,e.jsx)(c,{asChild:!0,variant:"outline",className:"h-12 text-base px-3",children:(0,e.jsx)(x,{prefetch:"intent",to:`/o/note/view/${t.id}`,children:(0,e.jsx)(D,{className:"h-5 w-5"})})})})})]},t.id))})]})}):(0,e.jsx)(R,{type:"notes",createLink:"/o/task/new",view:"list"}),o.totalResults>0&&(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4",children:[(0,e.jsx)(c,{onClick:()=>u(t=>(t.set("page",(n-1).toString()),t)),disabled:n===1,className:"w-full sm:w-auto h-12 text-base",children:"Pr\xE9c\xE9dent"}),(0,e.jsxs)("span",{className:"text-base",children:["Page ",n," sur ",Math.ceil(o.totalResults/d)]}),(0,e.jsx)(c,{onClick:()=>u(t=>(t.set("page",(n+1).toString()),t)),disabled:n*d>=o.totalResults,className:"w-full sm:w-auto h-12 text-base",children:"Suivant"})]})]})})]})}export{$ as default};
