import{a as Z}from"/build/_shared/chunk-6QXFNV75.js";import{a as ue}from"/build/_shared/chunk-M3SJMO64.js";import{a as U,b as M}from"/build/_shared/chunk-ABDDDOIB.js";import"/build/_shared/chunk-IEDNE26R.js";import{a as V,b as H,c as O,d as q,e as p}from"/build/_shared/chunk-NCY4KUS2.js";import"/build/_shared/chunk-Q6K63OHD.js";import"/build/_shared/chunk-KAUQO2FD.js";import"/build/_shared/chunk-7ZNTUDLC.js";import{a as Y}from"/build/_shared/chunk-OFTXZR4P.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as A}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-XNZ6DBKW.js";import"/build/_shared/chunk-YYMCCM4Y.js";import{a as me}from"/build/_shared/chunk-35S5HMBT.js";import"/build/_shared/chunk-2BPW44Z6.js";import"/build/_shared/chunk-5KYGR3MA.js";import{a as G,b as z,d as J,e as K,f as Q,g as W,h as X}from"/build/_shared/chunk-KLKNQD3Q.js";import"/build/_shared/chunk-PGURRWG5.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as ce}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as S,b as P,c as k,e as L,f as F}from"/build/_shared/chunk-G5A27C7O.js";import{h as s}from"/build/_shared/chunk-NVGVVEPD.js";import{Ea as j,K as R,P as B,Y as T,oa as $,ra as E,xa as I}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as v,h as b,k as c,l as N,p as y,r as C}from"/build/_shared/chunk-GTSSQFHM.js";import{a as ne,b as D}from"/build/_shared/chunk-BBTKOQ57.js";import{e as n}from"/build/_shared/chunk-UED2Q7CE.js";var m=n(ne()),de=n(me());var pe=n(ue());var ge=n(ce());var e=n(D());function _(){let{news:a,search:ee,page:r,limit:u,visibility:te,can:l}=y(),[h,w]=(0,m.useState)(!1),[fe,i]=b(),d=C(),se=v().state==="loading",[we,xe]=(0,m.useState)(!1),[ae,g]=(0,m.useState)(null);(0,m.useEffect)(()=>{d.state==="idle"&&d.data?.success&&w(!1)},[d.state,d.data]);let re=t=>{w(!0),d.submit({id:t,action:"delete"},{method:"post"}),g(null)},le=t=>{t.preventDefault();let f=new FormData(t.currentTarget).get("search");i(x=>(x.set("search",f),x))},ie=t=>{i(o=>(o.set("visibility",t),o))},oe=t=>t?(0,e.jsx)(B,{className:"h-4 w-4"}):(0,e.jsx)(T,{className:"h-4 w-4"});return(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 space-y-8",children:[(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,e.jsx)("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold",children:"Notes de Services"}),l?.create&&(0,e.jsx)(s,{asChild:!0,className:"w-full sm:w-auto h-12 text-base",children:(0,e.jsxs)(c,{prefetch:"intent",to:"/o/news/new",children:[(0,e.jsx)($,{className:"mr-2 h-5 w-5"}),"Nouvelle Publication"]})})]}),(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-4",children:[(0,e.jsxs)(N,{onSubmit:le,className:"flex items-center gap-2 w-full sm:w-auto sm:flex-1",children:[(0,e.jsx)(A,{type:"search",name:"search",placeholder:"Rechercher des notes de services...",defaultValue:ee,className:"h-12 text-base"}),(0,e.jsx)(s,{type:"submit",className:"h-12 w-12 flex-shrink-0",children:(0,e.jsx)(E,{className:"h-5 w-5"})})]}),(0,e.jsxs)(V,{value:te,onValueChange:ie,children:[(0,e.jsx)(O,{className:"h-12 text-base w-full sm:w-[200px]",children:(0,e.jsx)(H,{placeholder:"Filtrer par visibilit\xE9"})}),(0,e.jsxs)(q,{children:[(0,e.jsx)(p,{value:"all",className:"text-base",children:"Toutes"}),(0,e.jsx)(p,{value:"public",className:"text-base",children:"Publiques"}),(0,e.jsx)(p,{value:"private",className:"text-base",children:"Priv\xE9es"})]})]})]}),a.totalResults>0&&(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4",children:[(0,e.jsx)(s,{onClick:()=>i(t=>(t.set("page",(r-1).toString()),t)),disabled:r===1,className:"w-full sm:w-auto h-12 text-base",children:"Pr\xE9c\xE9dent"}),(0,e.jsxs)("span",{className:"text-base",children:["Page ",r," sur ",Math.ceil(a.totalResults/u)," /"," ",a.totalResults," notes de services"]}),(0,e.jsx)(s,{onClick:()=>i(t=>(t.set("page",(r+1).toString()),t)),disabled:r*u>=a.totalResults,className:"w-full sm:w-auto h-12 text-base",children:"Suivant"})]}),se?(0,e.jsx)(M,{view:"timeline",itemCount:u}):a.results.length>0?(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2 h-full w-1 bg-gray-200 hidden sm:block"}),(0,e.jsx)("div",{className:"space-y-6 sm:space-y-12",children:a.results.map((t,o)=>(0,e.jsxs)("div",{className:`relative ${o%2===0?"sm:ml-auto sm:pl-8":"sm:mr-auto sm:pr-8"} sm:w-1/2 w-full`,children:[(0,e.jsx)("div",{className:"absolute top-5 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-4 h-4 bg-primary rounded-full hidden sm:block"}),(0,e.jsxs)(S,{className:`w-full ${o%2===0?"sm:ml-4":"sm:mr-4"}`,children:[(0,e.jsxs)(P,{className:"p-4 sm:p-6",children:[(0,e.jsxs)(k,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[l?.view&&(0,e.jsx)(c,{prefetch:"intent",to:`/o/news/view/${t.id}`,children:(0,e.jsx)("span",{className:"text-xl sm:text-2xl",children:t.title})}),(0,e.jsxs)(Y,{variant:t.isPublic?"default":"secondary",className:"h-8 text-base px-3 py-1",children:[oe(t.isPublic),(0,e.jsx)("span",{className:"ml-2",children:t.isPublic?"Public":"Priv\xE9"})]})]}),l?.view&&(0,e.jsx)(c,{prefetch:"intent",to:`/o/news/view/${t.id}`,children:(0,e.jsx)("div",{className:"relative w-full h-40 sm:h-48 bg-cover bg-center rounded-md mt-4 text-center justify-center",style:{backgroundColor:" #00787d",backgroundImage:`url(${Z(t.attachments||[])?.file?.url})`},children:t.isEmergency==!0&&(0,e.jsx)("div",{className:"absolute top-2 left-2 bg-red-600 text-white px-2 py-1 rounded-md",children:"Urgence"})})})]}),(0,e.jsxs)(L,{className:"p-4 sm:p-6 space-y-2",children:[(0,e.jsxs)("p",{className:"text-base text-muted-foreground",children:["Type : ",t.type]}),(0,e.jsxs)("p",{className:"text-base text-muted-foreground",children:["Auteur : ",t.author.firstName," ",t.author.lastName]}),(0,e.jsxs)("p",{className:"text-base text-muted-foreground",children:["Mis \xE0 jour le :"," ",new Date(t.updatedAt).toLocaleString()]})]}),(0,e.jsxs)(F,{className:"p-4 sm:p-6 flex justify-between gap-3",children:[l?.view&&(0,e.jsx)(s,{asChild:!0,variant:"outline",className:"h-12 text-base flex-1",children:(0,e.jsx)(c,{prefetch:"intent",to:`/o/news/view/${t.id}`,children:(0,e.jsx)(R,{className:"mr-2 h-5 w-5"})})}),l?.edit&&(0,e.jsx)(s,{asChild:!0,variant:"outline",className:"h-12 text-base flex-1",children:(0,e.jsx)(c,{prefetch:"intent",to:`/o/news/edit/${t.id}`,children:(0,e.jsx)(I,{className:"mr-2 h-5 w-5"})})}),l?.delete&&(0,e.jsxs)(G,{open:ae===t.id,onOpenChange:f=>g(f?t.id:null),children:[(0,e.jsx)(z,{asChild:!0,children:(0,e.jsx)(s,{variant:"destructive",className:"h-12 text-base flex-1",children:(0,e.jsx)(j,{className:"mr-2 h-5 w-5"})})}),(0,e.jsxs)(J,{className:"sm:max-w-[425px]",children:[(0,e.jsxs)(K,{children:[(0,e.jsx)(W,{className:"text-xl",children:"\xCAtes-vous s\xFBr de vouloir supprimer cette actualit\xE9 ?"}),(0,e.jsx)(X,{className:"text-base",children:"Cette action ne peut pas \xEAtre annul\xE9e."})]}),(0,e.jsxs)(Q,{className:"gap-3 sm:gap-0",children:[(0,e.jsx)(s,{variant:"outline",onClick:()=>g(null),className:"h-12 text-base",children:"Annuler"}),(0,e.jsx)(s,{variant:"destructive",onClick:()=>re(t.id),disabled:h,className:"h-12 text-base",children:h?"Suppression...":"Supprimer"})]})]})]})]})]})]},t.id))})]}):(0,e.jsx)(U,{type:"notes de services",createLink:"/o/news/new",view:"timeline"}),a.totalResults>0&&(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4",children:[(0,e.jsx)(s,{onClick:()=>i(t=>(t.set("page",(r-1).toString()),t)),disabled:r===1,className:"w-full sm:w-auto h-12 text-base",children:"Pr\xE9c\xE9dent"}),(0,e.jsxs)("span",{className:"text-base",children:["Page ",r," sur ",Math.ceil(a.totalResults/u)," /"," ",a.totalResults," notes de services"]}),(0,e.jsx)(s,{onClick:()=>i(t=>(t.set("page",(r+1).toString()),t)),disabled:r*u>=a.totalResults,className:"w-full sm:w-auto h-12 text-base",children:"Suivant"})]})]})}export{_ as default};
