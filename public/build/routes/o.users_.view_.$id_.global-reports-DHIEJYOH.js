import{a as xe,b as Re,c as W,d as J}from"/build/_shared/chunk-Z7S4CDT2.js";import"/build/_shared/chunk-UNOET767.js";import{a as A,b as Se,c as j,d as b,e as Y,f as l}from"/build/_shared/chunk-IEDNE26R.js";import{a as Me,b as Ce}from"/build/_shared/chunk-FB4U2LCE.js";import{a as te,b as ae,c as ne,d as re,e as se}from"/build/_shared/chunk-NCY4KUS2.js";import"/build/_shared/chunk-Q6K63OHD.js";import"/build/_shared/chunk-KAUQO2FD.js";import"/build/_shared/chunk-7ZNTUDLC.js";import{a as Ye}from"/build/_shared/chunk-6JFOYO3V.js";import"/build/_shared/chunk-XNZ6DBKW.js";import"/build/_shared/chunk-YYMCCM4Y.js";import{a as Pe}from"/build/_shared/chunk-35S5HMBT.js";import"/build/_shared/chunk-2BPW44Z6.js";import"/build/_shared/chunk-5KYGR3MA.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as _e}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as ce,b as ue,c as de,e as fe}from"/build/_shared/chunk-G5A27C7O.js";import{h as $e}from"/build/_shared/chunk-NVGVVEPD.js";import{J as we,b as De}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as Te,i as pe,p as ge}from"/build/_shared/chunk-GTSSQFHM.js";import{a as Le,b as ye}from"/build/_shared/chunk-BBTKOQ57.js";import{c as ve,e as _}from"/build/_shared/chunk-UED2Q7CE.js";var Oe=ve((Be,Ne)=>{Ne.exports={}});var ke=ve((me,he)=>{(function(x,w){typeof me=="object"&&typeof he<"u"?he.exports=w():typeof define=="function"&&define.amd?define(w):(x=typeof globalThis<"u"?globalThis:x||self).dayjs=w()})(me,function(){"use strict";var x=1e3,w=6e4,q=36e5,k="millisecond",M="second",C="minute",H="hour",N="day",P="week",y="month",ie="quarter",$="year",O="date",V="Invalid Date",K=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,z=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Q={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(s){var n=["th","st","nd","rd"],t=s%100;return"["+s+(n[(t-20)%10]||n[t]||n[0])+"]"}},E=function(s,n,t){var r=String(s);return!r||r.length>=n?s:""+Array(n+1-r.length).join(t)+s},le={s:E,z:function(s){var n=-s.utcOffset(),t=Math.abs(n),r=Math.floor(t/60),a=t%60;return(n<=0?"+":"-")+E(r,2,"0")+":"+E(a,2,"0")},m:function s(n,t){if(n.date()<t.date())return-s(t,n);var r=12*(t.year()-n.year())+(t.month()-n.month()),a=n.clone().add(r,y),o=t-a<0,i=n.clone().add(r+(o?-1:1),y);return+(-(r+(t-a)/(o?a-i:i-a))||0)},a:function(s){return s<0?Math.ceil(s)||0:Math.floor(s)},p:function(s){return{M:y,y:$,w:P,d:N,D:O,h:H,m:C,s:M,ms:k,Q:ie}[s]||String(s||"").toLowerCase().replace(/s$/,"")},u:function(s){return s===void 0}},S="en",d={};d[S]=Q;var c="$isDayjsObject",p=function(s){return s instanceof X||!(!s||!s[c])},R=function s(n,t,r){var a;if(!n)return S;if(typeof n=="string"){var o=n.toLowerCase();d[o]&&(a=o),t&&(d[o]=t,a=o);var i=n.split("-");if(!a&&i.length>1)return s(i[0])}else{var f=n.name;d[f]=n,a=f}return!r&&a&&(S=a),a||!r&&S},h=function(s,n){if(p(s))return s.clone();var t=typeof n=="object"?n:{};return t.date=s,t.args=arguments,new X(t)},u=le;u.l=R,u.i=p,u.w=function(s,n){return h(s,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var X=function(){function s(t){this.$L=R(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[c]=!0}var n=s.prototype;return n.parse=function(t){this.$d=function(r){var a=r.date,o=r.utc;if(a===null)return new Date(NaN);if(u.u(a))return new Date;if(a instanceof Date)return new Date(a);if(typeof a=="string"&&!/Z$/i.test(a)){var i=a.match(K);if(i){var f=i[2]-1||0,m=(i[7]||"0").substring(0,3);return o?new Date(Date.UTC(i[1],f,i[3]||1,i[4]||0,i[5]||0,i[6]||0,m)):new Date(i[1],f,i[3]||1,i[4]||0,i[5]||0,i[6]||0,m)}}return new Date(a)}(t),this.init()},n.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},n.$utils=function(){return u},n.isValid=function(){return this.$d.toString()!==V},n.isSame=function(t,r){var a=h(t);return this.startOf(r)<=a&&a<=this.endOf(r)},n.isAfter=function(t,r){return h(t)<this.startOf(r)},n.isBefore=function(t,r){return this.endOf(r)<h(t)},n.$g=function(t,r,a){return u.u(t)?this[r]:this.set(a,t)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(t,r){var a=this,o=!!u.u(r)||r,i=u.p(t),f=function(I,g){var L=u.w(a.$u?Date.UTC(a.$y,g,I):new Date(a.$y,g,I),a);return o?L:L.endOf(N)},m=function(I,g){return u.w(a.toDate()[I].apply(a.toDate("s"),(o?[0,0,0,0]:[23,59,59,999]).slice(g)),a)},v=this.$W,T=this.$M,D=this.$D,U="set"+(this.$u?"UTC":"");switch(i){case $:return o?f(1,0):f(31,11);case y:return o?f(1,T):f(0,T+1);case P:var F=this.$locale().weekStart||0,G=(v<F?v+7:v)-F;return f(o?D-G:D+(6-G),T);case N:case O:return m(U+"Hours",0);case H:return m(U+"Minutes",1);case C:return m(U+"Seconds",2);case M:return m(U+"Milliseconds",3);default:return this.clone()}},n.endOf=function(t){return this.startOf(t,!1)},n.$set=function(t,r){var a,o=u.p(t),i="set"+(this.$u?"UTC":""),f=(a={},a[N]=i+"Date",a[O]=i+"Date",a[y]=i+"Month",a[$]=i+"FullYear",a[H]=i+"Hours",a[C]=i+"Minutes",a[M]=i+"Seconds",a[k]=i+"Milliseconds",a)[o],m=o===N?this.$D+(r-this.$W):r;if(o===y||o===$){var v=this.clone().set(O,1);v.$d[f](m),v.init(),this.$d=v.set(O,Math.min(this.$D,v.daysInMonth())).$d}else f&&this.$d[f](m);return this.init(),this},n.set=function(t,r){return this.clone().$set(t,r)},n.get=function(t){return this[u.p(t)]()},n.add=function(t,r){var a,o=this;t=Number(t);var i=u.p(r),f=function(T){var D=h(o);return u.w(D.date(D.date()+Math.round(T*t)),o)};if(i===y)return this.set(y,this.$M+t);if(i===$)return this.set($,this.$y+t);if(i===N)return f(1);if(i===P)return f(7);var m=(a={},a[C]=w,a[H]=q,a[M]=x,a)[i]||1,v=this.$d.getTime()+t*m;return u.w(v,this)},n.subtract=function(t,r){return this.add(-1*t,r)},n.format=function(t){var r=this,a=this.$locale();if(!this.isValid())return a.invalidDate||V;var o=t||"YYYY-MM-DDTHH:mm:ssZ",i=u.z(this),f=this.$H,m=this.$m,v=this.$M,T=a.weekdays,D=a.months,U=a.meridiem,F=function(g,L,Z,ee){return g&&(g[L]||g(r,o))||Z[L].slice(0,ee)},G=function(g){return u.s(f%12||12,g,"0")},I=U||function(g,L,Z){var ee=g<12?"AM":"PM";return Z?ee.toLowerCase():ee};return o.replace(z,function(g,L){return L||function(Z){switch(Z){case"YY":return String(r.$y).slice(-2);case"YYYY":return u.s(r.$y,4,"0");case"M":return v+1;case"MM":return u.s(v+1,2,"0");case"MMM":return F(a.monthsShort,v,D,3);case"MMMM":return F(D,v);case"D":return r.$D;case"DD":return u.s(r.$D,2,"0");case"d":return String(r.$W);case"dd":return F(a.weekdaysMin,r.$W,T,2);case"ddd":return F(a.weekdaysShort,r.$W,T,3);case"dddd":return T[r.$W];case"H":return String(f);case"HH":return u.s(f,2,"0");case"h":return G(1);case"hh":return G(2);case"a":return I(f,m,!0);case"A":return I(f,m,!1);case"m":return String(m);case"mm":return u.s(m,2,"0");case"s":return String(r.$s);case"ss":return u.s(r.$s,2,"0");case"SSS":return u.s(r.$ms,3,"0");case"Z":return i}return null}(g)||i.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(t,r,a){var o,i=this,f=u.p(r),m=h(t),v=(m.utcOffset()-this.utcOffset())*w,T=this-m,D=function(){return u.m(i,m)};switch(f){case $:o=D()/12;break;case y:o=D();break;case ie:o=D()/3;break;case P:o=(T-v)/6048e5;break;case N:o=(T-v)/864e5;break;case H:o=T/q;break;case C:o=T/w;break;case M:o=T/x;break;default:o=T}return a?o:u.a(o)},n.daysInMonth=function(){return this.endOf(y).$D},n.$locale=function(){return d[this.$L]},n.locale=function(t,r){if(!t)return this.$L;var a=this.clone(),o=R(t,r,!0);return o&&(a.$L=o),a},n.clone=function(){return u.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},s}(),be=X.prototype;return h.prototype=be,[["$ms",k],["$s",M],["$m",C],["$H",H],["$W",N],["$M",y],["$y",$],["$D",O]].forEach(function(s){be[s[1]]=function(n){return this.$g(n,s[0],s[1])}}),h.extend=function(s,n){return s.$i||(s(n,X,h),s.$i=!0),h},h.locale=R,h.isDayjs=p,h.unix=function(s){return h(1e3*s)},h.en=d[S],h.Ls=d,h.p={},h})});var Fe=_(Pe());var Ie=_(Oe()),Ae=_(Ye());var oe=_(ke()),B=_(Le());var je=_(_e());var e=_(ye());function He(){let{user:x,reportsData:w,comparisonMode:q,year:k,startMonth:M,endMonth:C,can:H}=ge(),P=Te().state==="loading",[y,ie]=(0,B.useState)("attendanceData"),[$,O]=(0,B.useState)(k||new Date().getFullYear().toString()),[V,K]=(0,B.useState)(M||"1"),[z,Q]=(0,B.useState)(C||"12"),E=pe();(0,B.useEffect)(()=>{k&&O(k),M&&K(M),C&&Q(C)},[k,M,C]);let le=()=>{E({year:$,startMonth:V,endMonth:z},{method:"get",replace:!0})},S=(d,c)=>{switch(d){case"attendanceData":return(0,e.jsx)(A,{children:(0,e.jsxs)(j,{children:[(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Heures totales travaill\xE9es"}),(0,e.jsxs)(l,{children:[c.attendanceData.totalHours.toFixed(2)," heures"]})]}),(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Heures moyennes par jour"}),(0,e.jsxs)(l,{children:[c.attendanceData.meanHours.toFixed(2)," heures"]})]}),(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Absences"}),(0,e.jsx)(l,{children:c.attendanceData.absences})]}),(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Retards"}),(0,e.jsx)(l,{children:c.attendanceData.lates})]}),(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Ratio Heures vs Pause"}),(0,e.jsx)(l,{children:c.attendanceData.workedVsPauseRatio.toFixed(2)})]}),(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Ratio Jours travaill\xE9s vs Jours totaux"}),(0,e.jsxs)(l,{children:[(c.attendanceData.workedDaysRatio*100).toFixed(2),"%"]})]})]})});case"taskData":return(0,e.jsx)(A,{children:(0,e.jsxs)(j,{children:[(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"T\xE2ches compl\xE9t\xE9es"}),(0,e.jsx)(l,{children:c.taskData.completed})]}),(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"T\xE2ches en cours"}),(0,e.jsx)(l,{children:c.taskData.inProgress})]}),(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Ratio Compl\xE9t\xE9es vs Total"}),(0,e.jsxs)(l,{children:[(c.taskData.ratioCompleted*100).toFixed(2),"%"]})]})]})});case"performanceData":return(0,e.jsx)(A,{children:(0,e.jsx)(j,{children:(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Score moyen des KPI"}),(0,e.jsx)(l,{children:c.performanceData.meanScore.toFixed(2)})]})})});case"observationData":return(0,e.jsx)(A,{children:(0,e.jsxs)(j,{children:[(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Observations positives"}),(0,e.jsx)(l,{children:c.observationData.positive})]}),(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Observations n\xE9gatives"}),(0,e.jsx)(l,{children:c.observationData.negative})]}),(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Ratio Positives vs N\xE9gatives"}),(0,e.jsxs)(l,{children:[(c.observationData.ratioPositive*100).toFixed(2),"%"]})]})]})});case"leaveData":return(0,e.jsx)(A,{children:(0,e.jsxs)(j,{children:[(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Nombre total de cong\xE9s"}),(0,e.jsx)(l,{children:c.leaveData.totalLeaves})]}),(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Ratio Cong\xE9s vs Jours totaux"}),(0,e.jsxs)(l,{children:[(c.leaveData.ratioLeaves*100).toFixed(2),"%"]})]}),(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:"Types de cong\xE9s"}),(0,e.jsx)(l,{children:(0,e.jsx)("ul",{className:"list-disc list-inside",children:Object.entries(c.leaveData.leavesByType).map(([p,R])=>(0,e.jsxs)("li",{children:[p,": ",R]},p))})})]})]})});default:return null}};return(0,e.jsxs)("div",{className:"min-h-screen bg-gray-100 p-4 sm:p-6 lg:p-8",children:[H?.view&&(0,e.jsx)("div",{className:"mb-6",children:(0,e.jsxs)("a",{href:`/o/users/view/${x.id}`,className:"flex items-center text-primary hover:text-primary-dark",children:[(0,e.jsx)(De,{className:"h-5 w-5 mr-2"}),(0,e.jsx)("span",{children:"Retour au profil"})]})}),(0,e.jsxs)(ce,{className:"mb-8",children:[(0,e.jsx)(ue,{children:(0,e.jsxs)(de,{children:["Rapport Global pour ",x.firstName," ",x.lastName]})}),(0,e.jsx)(fe,{children:(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-4",children:[(0,e.jsxs)(te,{value:$,onValueChange:O,children:[(0,e.jsx)(ne,{className:"w-full sm:w-48",children:(0,e.jsx)(ae,{placeholder:"S\xE9lectionnez l'ann\xE9e"})}),(0,e.jsx)(re,{children:Array.from({length:5}).map((d,c)=>{let p=new Date().getFullYear()-c;return(0,e.jsx)(se,{value:p.toString(),children:p},p)})})]}),(0,e.jsxs)(te,{value:V,onValueChange:K,children:[(0,e.jsx)(ne,{className:"w-full sm:w-48",children:(0,e.jsx)(ae,{placeholder:"Mois de d\xE9but"})}),(0,e.jsx)(re,{children:Array.from({length:12},(d,c)=>c+1).map(d=>(0,e.jsx)(se,{value:d.toString(),children:(0,oe.default)().month(d-1).format("MMMM")},d))})]}),(0,e.jsxs)(te,{value:z,onValueChange:Q,children:[(0,e.jsx)(ne,{className:"w-full sm:w-48",children:(0,e.jsx)(ae,{placeholder:"Mois de fin"})}),(0,e.jsx)(re,{children:Array.from({length:12},(d,c)=>c+1).map(d=>(0,e.jsx)(se,{value:d.toString(),children:(0,oe.default)().month(d-1).format("MMMM")},d))})]}),(0,e.jsx)($e,{onClick:le,className:"w-full sm:w-auto",children:"Afficher le rapport"})]})})]}),(0,e.jsx)("div",{className:"mb-6 flex justify-center",children:(0,e.jsxs)("a",{href:`/o/users/view/${x.id}/global-reports/csv?year=${$}&startMonth=${V}&endMonth=${z}`,className:"inline-flex items-center space-x-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md",children:[(0,e.jsx)(we,{className:"h-5 w-5"}),(0,e.jsx)("span",{children:"T\xE9l\xE9charger le rapport (CSV)"})]})}),P&&(0,e.jsx)("div",{className:"flex justify-center items-center",children:(0,e.jsxs)("svg",{className:"animate-spin h-8 w-8 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,e.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,e.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]})}),!P&&w&&(0,e.jsx)(Me,{children:(0,e.jsxs)(Ce.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},className:"space-y-8",children:[(0,e.jsxs)(ce,{children:[(0,e.jsx)(ue,{children:(0,e.jsx)(de,{children:q?"Comparaison Globale":"Rapport Global"})}),(0,e.jsx)(fe,{children:(0,e.jsxs)(A,{children:[(0,e.jsx)(Se,{children:(0,e.jsxs)(b,{children:[(0,e.jsx)(Y,{children:"P\xE9riode"}),(0,e.jsx)(Y,{children:"Heures Travaill\xE9es"}),(0,e.jsx)(Y,{children:"T\xE2ches Compl\xE9t\xE9es"}),(0,e.jsx)(Y,{children:"Score KPI Moyen"}),(0,e.jsx)(Y,{children:"Observations Positives"}),(0,e.jsx)(Y,{children:"Observations N\xE9gatives"}),(0,e.jsx)(Y,{children:"Cong\xE9s Totaux"})]})}),(0,e.jsx)(j,{children:Object.entries(w).map(([d,c])=>{let[p,R]=d.split("-");return(0,e.jsxs)(b,{children:[(0,e.jsx)(l,{children:`${R}/${p}`}),(0,e.jsx)(l,{children:c.attendanceData.totalHours.toFixed(2)}),(0,e.jsx)(l,{children:c.taskData.completed}),(0,e.jsx)(l,{children:c.performanceData.meanScore.toFixed(2)}),(0,e.jsx)(l,{children:c.observationData.positive}),(0,e.jsx)(l,{children:c.observationData.negative}),(0,e.jsx)(l,{children:c.leaveData.totalLeaves})]},d)})})]})})]}),(0,e.jsxs)(xe,{defaultValue:"attendanceData",className:"w-full",children:[(0,e.jsxs)(Re,{className:"grid w-full grid-cols-5",children:[(0,e.jsx)(W,{value:"attendanceData",children:"Pr\xE9sence"}),(0,e.jsx)(W,{value:"taskData",children:"T\xE2ches"}),(0,e.jsx)(W,{value:"performanceData",children:"Performance"}),(0,e.jsx)(W,{value:"observationData",children:"Observations"}),(0,e.jsx)(W,{value:"leaveData",children:"Cong\xE9s"})]}),Object.entries(w).map(([d,c])=>{let[p,R]=d.split("-"),h=(0,oe.default)(`${p}-${R}-01`).format("MMMM YYYY");return(0,e.jsxs)("div",{className:"mt-4",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold mb-2",children:h}),(0,e.jsx)(J,{value:"attendanceData",children:S("attendanceData",c)}),(0,e.jsx)(J,{value:"taskData",children:S("taskData",c)}),(0,e.jsx)(J,{value:"performanceData",children:S("performanceData",c)}),(0,e.jsx)(J,{value:"observationData",children:S("observationData",c)}),(0,e.jsx)(J,{value:"leaveData",children:S("leaveData",c)})]},d)})]})]})})]})}export{He as default};
