import{a as X}from"/build/_shared/chunk-KOQ6QM7E.js";import{a as B}from"/build/_shared/chunk-A762UFCP.js";import"/build/_shared/chunk-RHTBOEYQ.js";import"/build/_shared/chunk-HNF2M344.js";import"/build/_shared/chunk-IQV4D3C7.js";import"/build/_shared/chunk-H33OI7YH.js";import"/build/_shared/chunk-JBQJJPFB.js";import{b as c}from"/build/_shared/chunk-SS7AQOQ3.js";import{a as O,b as U,c as T}from"/build/_shared/chunk-2MHSPA7K.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as u}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-XNZ6DBKW.js";import"/build/_shared/chunk-YYMCCM4Y.js";import{a as Y}from"/build/_shared/chunk-35S5HMBT.js";import"/build/_shared/chunk-2BPW44Z6.js";import"/build/_shared/chunk-5KYGR3MA.js";import"/build/_shared/chunk-KLKNQD3Q.js";import"/build/_shared/chunk-PGURRWG5.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as Q}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as S,b as C,c as A,e as D}from"/build/_shared/chunk-G5A27C7O.js";import{h as n}from"/build/_shared/chunk-NVGVVEPD.js";import{Ea as j,X as R,b as I,oa as F,t as L}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as w,i as v,k as N,l as b,p as y,q as x}from"/build/_shared/chunk-GTSSQFHM.js";import{a as K,b as E}from"/build/_shared/chunk-BBTKOQ57.js";import{e as o}from"/build/_shared/chunk-UED2Q7CE.js";var i=o(K()),Z=o(Y());var ee=o(X()),te=o(Q());var e=o(E());function k(){let{report:m,users:se,can:M}=y(),[$,q]=(0,i.useState)(m.attachments),d=x(),p=w(),[r,l]=(0,i.useState)(m.items),[f,H]=(0,i.useState)(!1),[W,P]=(0,i.useState)(!1),z=()=>{l([...r,{description:"",amount:""}])},J=s=>{l(r.filter((t,a)=>a!==s))},h=(s,t,a)=>{let g=[...r];g[s][t]=a,l(g)},V=v(),_=s=>{H(!0),s.preventDefault();let t=new FormData(s.currentTarget);$.forEach(a=>{t.append("attachments",a.id)}),V(t,{method:"post"})},G=s=>{q(s)};return(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 max-w-2xl",children:[M?.list&&(0,e.jsx)(n,{asChild:!0,variant:"outline",className:"mb-6 h-11 text-base",children:(0,e.jsxs)(N,{prefetch:"intent",to:"/o/expense-report",children:[(0,e.jsx)(I,{className:"mr-2 h-5 w-5"}),"Retour \xE0 la liste"]})}),(0,e.jsxs)(S,{className:"w-full",children:[(0,e.jsx)(C,{className:"p-4 sm:p-6",children:(0,e.jsx)(A,{className:"text-xl sm:text-2xl lg:text-3xl font-bold",children:"Modifier la note de frais"})}),(0,e.jsxs)(D,{className:"p-4 sm:p-6 space-y-6",children:[d?.error&&(0,e.jsxs)(O,{variant:"destructive",children:[(0,e.jsx)(L,{className:"h-5 w-5"}),(0,e.jsx)(U,{className:"text-base font-medium",children:"Erreur"}),(0,e.jsx)(T,{className:"text-base",children:d.error})]}),(0,e.jsx)(b,{method:"post",onSubmit:_,className:"space-y-6",children:(0,e.jsxs)("div",{className:"space-y-4",children:[r.map((s,t)=>(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 sm:items-end",children:[(0,e.jsxs)("div",{className:"flex-grow space-y-2",children:[(0,e.jsx)(c,{htmlFor:`description-${t}`,className:"text-base font-medium",children:"Description"}),(0,e.jsx)(u,{id:`description-${t}`,value:s.description,onChange:a=>h(t,"description",a.target.value),required:!0,className:"h-11 text-base"})]}),(0,e.jsxs)("div",{className:"w-full sm:w-1/4 space-y-2",children:[(0,e.jsx)(c,{htmlFor:`amount-${t}`,className:"text-base font-medium",children:"Montant"}),(0,e.jsx)(u,{id:`amount-${t}`,type:"number",step:"0.01",value:s.amount,onChange:a=>h(t,"amount",a.target.value),required:!0,className:"h-11 text-base"})]}),(0,e.jsx)(n,{type:"button",variant:"outline",onClick:()=>J(t),className:"h-11 w-11",children:(0,e.jsx)(j,{className:"h-5 w-5"})})]},t)),(0,e.jsxs)(n,{type:"button",onClick:z,className:"w-full h-11 text-base",children:[(0,e.jsx)(F,{className:"mr-2 h-5 w-5"}),"Ajouter un \xE9l\xE9ment"]}),(0,e.jsx)("input",{type:"hidden",name:"items",value:JSON.stringify(r)}),(0,e.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,e.jsx)(c,{htmlFor:"attachments",className:"text-base font-medium",children:"Images & Pi\xE8ces jointes"}),(0,e.jsx)(B,{onSelect:G,defaultSelectedDocuments:m.attachments,multiple:!0,accept:"image/*,application/pdf",maxSize:5*1024*1024,onBusyStateChange:P,className:"w-full"})]}),(0,e.jsx)(n,{type:"submit",className:"w-full h-11 text-base",disabled:f||W||p.state==="submitting",children:f||p.state==="submitting"?(0,e.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,e.jsx)(R,{className:"h-5 w-5 animate-spin"}),"Mise \xE0 jour..."]}):"Mettre \xE0 jour la note de frais"})]})})]})]})]})}export{k as default};
