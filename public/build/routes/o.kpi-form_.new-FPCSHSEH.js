import{a as Y}from"/build/_shared/chunk-UYD3XYD3.js";import{a as X}from"/build/_shared/chunk-XKJ5LF2E.js";import{a as h}from"/build/_shared/chunk-XDNDK56N.js";import"/build/_shared/chunk-KAUQO2FD.js";import"/build/_shared/chunk-7ZNTUDLC.js";import{a as V}from"/build/_shared/chunk-6JFOYO3V.js";import{a as b}from"/build/_shared/chunk-L2TBXS32.js";import{a as f}from"/build/_shared/chunk-JBQJJPFB.js";import{b as r}from"/build/_shared/chunk-SS7AQOQ3.js";import{a as j,b as B,c as E}from"/build/_shared/chunk-2MHSPA7K.js";import{a as u}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-YYMCCM4Y.js";import{a as W}from"/build/_shared/chunk-35S5HMBT.js";import"/build/_shared/chunk-5KYGR3MA.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as Q}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as o,b as l,c as d,e as p,f as k}from"/build/_shared/chunk-G5A27C7O.js";import{h as c}from"/build/_shared/chunk-NVGVVEPD.js";import{Ea as R,X as I,b as L,oa as K,t as D}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as w,k as A,l as F,p as S,q as T}from"/build/_shared/chunk-GTSSQFHM.js";import{a as J,b as $}from"/build/_shared/chunk-BBTKOQ57.js";import{e as s}from"/build/_shared/chunk-UED2Q7CE.js";var N=s(J()),Z=s(W());var ee=s(Y()),te=s(Q()),ae=s(X()),se=s(V());var e=s($());function M(){let{users:P,positions:U}=S(),x=T(),C=w(),[v,q]=(0,N.useState)(!1),[n,y]=(0,N.useState)([{name:"",maxScore:0,description:""}]),[m,H]=(0,N.useState)({users:[],positions:[]}),g=(t,a)=>{H(i=>({...i,[t]:i[t].includes(a)?i[t].filter(G=>G!==a):[...i[t],a]}))},O=()=>{q(!0)},_=()=>{y([...n,{name:"",maxScore:0,description:""}])},z=t=>{y(n.filter((a,i)=>i!==t))};return(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:py-10",children:[(0,e.jsx)(c,{asChild:!0,variant:"outline",className:"mb-6 h-11 text-base",children:(0,e.jsxs)(A,{prefetch:"intent",to:"/o/kpi-form",children:[(0,e.jsx)(L,{className:"mr-2 h-5 w-5"}),"Retour \xE0 la liste"]})}),(0,e.jsxs)(o,{className:"max-w-2xl mx-auto",children:[(0,e.jsx)(l,{className:"p-4 sm:p-6",children:(0,e.jsx)(d,{className:"text-xl sm:text-2xl lg:text-3xl font-bold",children:"Nouveau Formulaire KPI"})}),(0,e.jsxs)(F,{method:"post",onSubmit:O,children:[(0,e.jsxs)(p,{className:"p-4 sm:p-6 space-y-6",children:[x?.error&&(0,e.jsxs)(j,{variant:"destructive",children:[(0,e.jsx)(D,{className:"h-5 w-5"}),(0,e.jsx)(B,{className:"text-base font-medium",children:"Erreur"}),(0,e.jsx)(E,{className:"text-base",children:x.error})]}),(0,e.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,e.jsx)(r,{htmlFor:"title",className:"text-base font-medium",children:"Titre"}),(0,e.jsx)(u,{id:"title",name:"title",required:!0,className:"h-11 text-base"})]}),(0,e.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,e.jsx)(r,{htmlFor:"description",className:"text-base font-medium",children:"Description"}),(0,e.jsx)(b,{id:"description",name:"description",className:"min-h-[120px] text-base p-3"})]}),(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)("h2",{className:"text-lg sm:text-xl font-semibold",children:"Crit\xE8res"}),n.map((t,a)=>(0,e.jsxs)(o,{className:"p-4 sm:p-6",children:[(0,e.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,e.jsxs)("h3",{className:"text-lg font-medium",children:["Crit\xE8re ",a+1]}),(0,e.jsx)(c,{type:"button",variant:"destructive",onClick:()=>z(a),className:"h-11 w-11",children:(0,e.jsx)(R,{className:"h-5 w-5"})})]}),(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,e.jsx)(r,{htmlFor:`criterionName${a}`,className:"text-base font-medium",children:"Nom"}),(0,e.jsx)(u,{id:`criterionName${a}`,name:`criterionName${a}`,required:!0,className:"h-11 text-base"})]}),(0,e.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,e.jsx)(r,{htmlFor:`criterionMaxScore${a}`,className:"text-base font-medium",children:"Note maximale"}),(0,e.jsx)(u,{type:"number",id:`criterionMaxScore${a}`,name:`criterionMaxScore${a}`,required:!0,min:"1",className:"h-11 text-base"})]}),(0,e.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,e.jsx)(r,{htmlFor:`criterionDescription${a}`,className:"text-base font-medium",children:"Description"}),(0,e.jsx)(b,{id:`criterionDescription${a}`,name:`criterionDescription${a}`,className:"min-h-[120px] text-base p-3"})]})]})]},a)),(0,e.jsxs)(c,{type:"button",onClick:_,className:"w-full h-11 text-base",children:[(0,e.jsx)(K,{className:"mr-2 h-5 w-5"}),"Ajouter un crit\xE8re"]})]}),(0,e.jsx)("input",{type:"hidden",name:"criteriaCount",value:n.length}),(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)(r,{className:"text-base font-medium",children:"Applicable \xE0"}),(0,e.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,e.jsxs)(o,{className:"shadow-none border",children:[(0,e.jsx)(l,{className:"p-4",children:(0,e.jsx)(d,{className:"text-base font-semibold",children:"Employ\xE9(s)"})}),(0,e.jsx)(p,{className:"p-0",children:(0,e.jsx)(h,{className:"h-48 px-4",children:P.map(t=>(0,e.jsxs)("div",{className:"flex items-center space-x-3 py-3",children:[(0,e.jsx)(f,{id:`user-${t.id}`,checked:m.users.includes(t.id),onCheckedChange:()=>g("users",t.id),className:"h-5 w-5"}),(0,e.jsxs)("label",{htmlFor:`user-${t.id}`,className:"text-base",children:[t.firstName," ",t.lastName]}),m.users.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"applicableTo.users",value:t.id})]},t.id))})})]}),(0,e.jsxs)(o,{className:"shadow-none border",children:[(0,e.jsx)(l,{className:"p-4",children:(0,e.jsx)(d,{className:"text-base font-semibold",children:"Fiches de Poste"})}),(0,e.jsx)(p,{className:"p-0",children:(0,e.jsx)(h,{className:"h-48 px-4",children:U.map(t=>(0,e.jsxs)("div",{className:"flex items-center space-x-3 py-3",children:[(0,e.jsx)(f,{id:`position-${t.id}`,checked:m.positions.includes(t.id),onCheckedChange:()=>g("positions",t.id),className:"h-5 w-5"}),(0,e.jsx)("label",{htmlFor:`position-${t.id}`,className:"text-base",children:t.title}),m.positions.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"applicableTo.positions",value:t.id})]},t.id))})})]})]})]})]}),(0,e.jsx)(k,{className:"p-4 sm:p-6",children:(0,e.jsx)(c,{type:"submit",className:"w-full h-11 text-base",disabled:v||C.state==="submitting",children:v||C.state==="submitting"?(0,e.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,e.jsx)(I,{className:"h-5 w-5 animate-spin"}),"Cr\xE9ation en cours..."]}):"Cr\xE9er le formulaire KPI"})})]})]})]})}export{M as default};
