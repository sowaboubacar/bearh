import{a as G}from"/build/_shared/chunk-KOQ6QM7E.js";import{a as C,b as P}from"/build/_shared/chunk-ABDDDOIB.js";import{a as D}from"/build/_shared/chunk-LZOQ52E6.js";import"/build/_shared/chunk-MRGZKXS3.js";import{a as S,b as F,c as L,d as p,e as s,f as o}from"/build/_shared/chunk-IEDNE26R.js";import{b as l}from"/build/_shared/chunk-FB4U2LCE.js";import{a as X}from"/build/_shared/chunk-6JFOYO3V.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as R}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as O}from"/build/_shared/chunk-B6OA2ZRE.js";import"/build/_shared/chunk-G5A27C7O.js";import{h as n}from"/build/_shared/chunk-NVGVVEPD.js";import{K as N,ra as T}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as h,h as b,k as g,l as w,p as x,r as v}from"/build/_shared/chunk-GTSSQFHM.js";import{a as V,b as y}from"/build/_shared/chunk-BBTKOQ57.js";import{e as a}from"/build/_shared/chunk-UED2Q7CE.js";var J=a(O()),H=a(V());var q=a(X()),z=a(G());var e=a(y());function k(){let{reports:r,search:c,user:B,page:i,limit:m,can:u}=x(),[K,E]=(0,H.useState)(!1),[Q,d]=b(),A=v(),U=h().state==="loading",Y=(t,f)=>{E(!0),A.submit({id:t,action:f},{method:"post",action:"o/expense-report"})},$=t=>new Date(t).toLocaleDateString("fr-FR"),j=t=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XOF"}).format(t),I=t=>{t.preventDefault();let M=new FormData(t.currentTarget).get("search");d({search:M})};return(0,e.jsxs)(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"container mx-auto p-4 space-y-6 max-w-8xl",children:[(0,e.jsxs)(l.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},className:"mb-6",children:[(0,e.jsx)(D,{user:B,can:u}),(0,e.jsx)("h1",{className:"text-3xl font-bold mt-4 text-center",children:"Notes de frais"})]}),(0,e.jsx)(l.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 space-y-6",children:[(0,e.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-4",children:(0,e.jsxs)(w,{className:"flex items-center gap-2 w-full sm:w-auto sm:flex-1",onSubmit:I,children:[(0,e.jsx)(R,{type:"search",name:"search",placeholder:"Rechercher des notes de frais",defaultValue:c??"",className:"h-12 text-base rounded-full border-2 border-primary"}),(0,e.jsx)(n,{type:"submit",className:"h-12 w-12 flex-shrink-0  rounded-full border-2 border-primary",children:(0,e.jsx)(T,{className:"h-5 w-5"})})]})}),U?(0,e.jsx)(P,{view:"list",itemCount:m}):r.results.length>0?(0,e.jsx)("div",{className:"rounded-lg border overflow-x-auto",children:(0,e.jsxs)(S,{children:[(0,e.jsx)(F,{children:(0,e.jsxs)(p,{children:[(0,e.jsx)(s,{className:"text-base whitespace-nowrap",children:"Date de soumission"}),(0,e.jsx)(s,{className:"text-base whitespace-nowrap hidden sm:table-cell",children:"Montant total"}),(0,e.jsx)(s,{className:"text-base whitespace-nowrap hidden sm:table-cell",children:"Statut"}),(0,e.jsx)(s,{className:"text-base whitespace-nowrap hidden sm:table-cell",children:"Pi\xE8ces Jointes"}),(0,e.jsx)(s,{className:"text-base text-right",children:"Actions"})]})}),(0,e.jsx)(L,{children:r.results.map(t=>(0,e.jsxs)(p,{children:[(0,e.jsx)(o,{className:"font-medium text-base",children:$(t.submissionDate)}),(0,e.jsx)(o,{className:"text-base hidden sm:table-cell",children:j(t.totalAmount)}),(0,e.jsx)(o,{className:"text-base hidden sm:table-cell",children:t.status}),(0,e.jsx)(o,{className:"text-base hidden sm:table-cell",children:t.attachments.length}),(0,e.jsx)(o,{children:(0,e.jsx)("div",{className:"flex justify-end gap-2",children:u?.expenseReport&&(0,e.jsx)(n,{asChild:!0,variant:"outline",className:"h-11 w-11",children:(0,e.jsx)(g,{prefetch:"intent",to:`/o/expense-report/view/${t.id}`,children:(0,e.jsx)(N,{className:"h-5 w-5"})})})})})]},t.id))})]})}):(0,e.jsx)(C,{type:"tasks",createLink:"/o/task/new",view:"list"}),r.totalResults>0&&(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4",children:[(0,e.jsx)(n,{onClick:()=>d({search:c,page:(i-1).toString()}),disabled:i===1,className:"w-full sm:w-auto h-11 text-base",children:"Pr\xE9c\xE9dent"}),(0,e.jsxs)("span",{className:"text-base",children:["Page ",i," sur ",Math.ceil(r.totalResults/m)]}),(0,e.jsx)(n,{onClick:()=>d({search:c,page:(i+1).toString()}),disabled:i*m>=r.totalResults,className:"w-full sm:w-auto h-11 text-base",children:"Suivant"})]})]})})]})}export{k as default};
