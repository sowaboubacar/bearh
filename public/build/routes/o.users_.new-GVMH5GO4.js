import{a as Ne}from"/build/_shared/chunk-YWUCPBEQ.js";import{a as K}from"/build/_shared/chunk-XDNDK56N.js";import{a as V,b as q,c as z,d as H,e as O}from"/build/_shared/chunk-NCY4KUS2.js";import"/build/_shared/chunk-Q6K63OHD.js";import"/build/_shared/chunk-KAUQO2FD.js";import"/build/_shared/chunk-7ZNTUDLC.js";import{a as ge}from"/build/_shared/chunk-6JFOYO3V.js";import{a as G}from"/build/_shared/chunk-A762UFCP.js";import"/build/_shared/chunk-RHTBOEYQ.js";import"/build/_shared/chunk-HNF2M344.js";import"/build/_shared/chunk-IQV4D3C7.js";import"/build/_shared/chunk-H33OI7YH.js";import{a as p}from"/build/_shared/chunk-JBQJJPFB.js";import{b as s}from"/build/_shared/chunk-SS7AQOQ3.js";import{a as W,b as $,c as J}from"/build/_shared/chunk-2MHSPA7K.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as r}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-XNZ6DBKW.js";import"/build/_shared/chunk-YYMCCM4Y.js";import{a as fe}from"/build/_shared/chunk-35S5HMBT.js";import"/build/_shared/chunk-2BPW44Z6.js";import"/build/_shared/chunk-5KYGR3MA.js";import"/build/_shared/chunk-KLKNQD3Q.js";import"/build/_shared/chunk-PGURRWG5.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as pe}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as b,b as P,c as T,e as B}from"/build/_shared/chunk-G5A27C7O.js";import{h as c}from"/build/_shared/chunk-NVGVVEPD.js";import{Ea as x,X as M,b as R,oa as y,t as j}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as A,i as E,k,l as I,p as L,q as F}from"/build/_shared/chunk-GTSSQFHM.js";import{a as ue,b as U}from"/build/_shared/chunk-BBTKOQ57.js";import{e as l}from"/build/_shared/chunk-UED2Q7CE.js";var o=l(ue()),ve=l(fe());var he=l(ge()),be=l(pe());var ye=l(Ne());var e=l(U());function Q(){let{users:X,accesses:Y}=L(),D=F(),w=A(),[C,Z]=(0,o.useState)(!1),[xe,_]=(0,o.useState)(null),[ee,te]=(0,o.useState)(!1),[S,ae]=(0,o.useState)([]),se=t=>{ae(a=>a.includes(t)?a.filter(i=>i!==t):[...a,t])},[m,De]=(0,o.useState)({firstName:"",lastName:"",password:"",email:"",access:null,supervisors:[],payroll:{earnings:[],deductions:[]}}),[g,re]=(0,o.useState)([]),[d,f]=(0,o.useState)([]),[u,N]=(0,o.useState)([]),oe=E(),ie=t=>{t.preventDefault(),Z(!0);let a=new FormData(t.currentTarget);g.forEach(i=>{a.append("attachments",i.id)}),a.append("payroll",JSON.stringify({earnings:d,deductions:u})),oe(a,{method:"post"})},ne=t=>{re(t),g.length>0&&_(g[0])},le=()=>{let t={id:crypto.randomUUID(),description:"",amount:0,isPercentage:!1};f([...d,t])},ce=()=>{let t={id:crypto.randomUUID(),description:"",amount:0,isPercentage:!1};N([...u,t])},v=(t,a,i)=>{f(d.map(n=>n.id===t?{...n,[a]:i}:n))},h=(t,a,i)=>{N(u.map(n=>n.id===t?{...n,[a]:i}:n))},me=t=>{f(d.filter(a=>a.id!==t))},de=t=>{N(u.filter(a=>a.id!==t))};return(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 max-w-3xl",children:[(0,e.jsx)(c,{asChild:!0,variant:"outline",className:"mb-6 h-12 text-base",children:(0,e.jsxs)(k,{prefetch:"intent",to:"/o/users",children:[(0,e.jsx)(R,{className:"mr-2 h-5 w-5"}),"Retour \xE0 la liste"]})}),(0,e.jsxs)(b,{children:[(0,e.jsx)(P,{className:"p-4 sm:p-6",children:(0,e.jsx)(T,{className:"text-2xl sm:text-3xl font-bold",children:"Nouvel Employ\xE9"})}),(0,e.jsxs)(B,{className:"p-4 sm:p-6 space-y-6",children:[D?.error&&(0,e.jsxs)(W,{variant:"destructive",children:[(0,e.jsx)(j,{className:"h-5 w-5"}),(0,e.jsx)($,{className:"text-base font-medium",children:"Erreur"}),(0,e.jsx)(J,{className:"text-base",children:D.error})]}),(0,e.jsxs)(I,{method:"post",onSubmit:ie,children:[(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(s,{htmlFor:"attachments",className:"text-base font-medium text-center block",children:"Avatar (Photo de Profile)"}),(0,e.jsx)(G,{onSelect:ne,defaultSelectedDocuments:[],multiple:!1,accept:"image/*",maxSize:1*1024*1024,onBusyStateChange:te,isAvatar:!0})]}),(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(s,{htmlFor:"firstName",className:"text-base font-medium",children:"Pr\xE9nom"}),(0,e.jsx)(r,{type:"text",id:"firstName",name:"firstName",defaultValue:m.firstName,required:!0,className:"h-12 text-base"})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(s,{htmlFor:"lastName",className:"text-base font-medium",children:"Nom"}),(0,e.jsx)(r,{type:"text",id:"lastName",name:"lastName",defaultValue:m.lastName,required:!0,className:"h-12 text-base"})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(s,{htmlFor:"email",className:"text-base font-medium",children:"Email"}),(0,e.jsx)(r,{type:"email",id:"email",name:"email",defaultValue:m.email,required:!0,className:"h-12 text-base"})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(s,{htmlFor:"password",className:"text-base font-semibold text-green-800",children:"Mot de passe (Il peut changer plus tard)"}),(0,e.jsx)(r,{type:"text",id:"password",name:"password",defaultValue:m.password,required:!0,className:"h-12 text-base"})]})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(s,{htmlFor:"access",className:"text-base font-medium",children:"Droit d'Acc\xE8s"}),(0,e.jsxs)(V,{name:"access",defaultValue:m.access?.id,children:[(0,e.jsx)(z,{className:"h-12 text-base",children:(0,e.jsx)(q,{placeholder:"S\xE9lectionnez un droit d'acc\xE8s"})}),(0,e.jsx)(H,{children:Y.map(t=>(0,e.jsx)(O,{value:t.id,className:"text-base",children:t.name},t.id))})]})]}),(0,e.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,e.jsx)(s,{className:"text-base font-medium",children:"S\xE9lectionner ses superviseurs"}),(0,e.jsx)(b,{children:(0,e.jsx)(K,{className:"h-72 sm:h-80 w-full rounded-md border p-4",children:X.map(t=>(0,e.jsxs)("div",{className:"flex items-center space-x-3 py-3 sm:py-4",children:[(0,e.jsx)(p,{id:`user-${t.id}`,checked:S.includes(t.id),onCheckedChange:()=>se(t.id),className:"h-5 w-5 sm:h-6 sm:w-6"}),(0,e.jsxs)("label",{htmlFor:`user-${t.id}`,className:"text-base font-medium cursor-pointer",children:[t.firstName," ",t.lastName]}),S.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"supervisors",value:t.id})]},t.id))})})]}),(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)(s,{className:"text-base font-medium",children:"Revenus"}),d.map(t=>(0,e.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,e.jsx)(r,{type:"text",placeholder:"Description",value:t.description,onChange:a=>v(t.id,"description",a.target.value),className:"flex-1"}),(0,e.jsx)(r,{type:"number",placeholder:"Montant",value:t.amount,onChange:a=>v(t.id,"amount",parseFloat(a.target.value)),className:"w-32"}),(0,e.jsx)(p,{checked:t.isPercentage,onCheckedChange:a=>v(t.id,"isPercentage",!!a)}),(0,e.jsx)(s,{className:"text-sm",children:"%"}),(0,e.jsx)(c,{type:"button",variant:"ghost",size:"icon",onClick:()=>me(t.id),children:(0,e.jsx)(x,{className:"h-4 w-4"})})]},t.id)),(0,e.jsxs)(c,{type:"button",variant:"outline",onClick:le,className:"w-full",children:[(0,e.jsx)(y,{className:"mr-2 h-4 w-4"}),"Ajouter un revenu"]})]}),(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)(s,{className:"text-base font-medium",children:"D\xE9ductions"}),u.map(t=>(0,e.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,e.jsx)(r,{type:"text",placeholder:"Description",value:t.description,onChange:a=>h(t.id,"description",a.target.value),className:"flex-1"}),(0,e.jsx)(r,{type:"number",placeholder:"Montant",value:t.amount,onChange:a=>h(t.id,"amount",parseFloat(a.target.value)),className:"w-32"}),(0,e.jsx)(p,{checked:t.isPercentage,onCheckedChange:a=>h(t.id,"isPercentage",!!a)}),(0,e.jsx)(s,{className:"text-sm",children:"%"}),(0,e.jsx)(c,{type:"button",variant:"ghost",size:"icon",onClick:()=>de(t.id),children:(0,e.jsx)(x,{className:"h-4 w-4"})})]},t.id)),(0,e.jsxs)(c,{type:"button",variant:"outline",onClick:ce,className:"w-full",children:[(0,e.jsx)(y,{className:"mr-2 h-4 w-4"}),"Ajouter une d\xE9duction"]})]})]}),(0,e.jsx)(c,{type:"submit",className:"w-full h-12 text-base",disabled:C||ee||w.state==="submitting",children:C||w.state==="submitting"?(0,e.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,e.jsx)(M,{className:"h-5 w-5 animate-spin"}),"Enregistrement..."]}):"Ajouter l'utilisateur"})]})]})]})]})]})}export{Q as default};
