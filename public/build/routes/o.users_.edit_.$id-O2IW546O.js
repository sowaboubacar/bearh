import{a as he}from"/build/_shared/chunk-YWUCPBEQ.js";import{a as Q}from"/build/_shared/chunk-XDNDK56N.js";import{a as z,b as H,c as V,d as q,e as W}from"/build/_shared/chunk-NCY4KUS2.js";import"/build/_shared/chunk-Q6K63OHD.js";import"/build/_shared/chunk-KAUQO2FD.js";import"/build/_shared/chunk-7ZNTUDLC.js";import{a as ve}from"/build/_shared/chunk-6JFOYO3V.js";import{a as K}from"/build/_shared/chunk-A762UFCP.js";import"/build/_shared/chunk-RHTBOEYQ.js";import"/build/_shared/chunk-HNF2M344.js";import"/build/_shared/chunk-IQV4D3C7.js";import"/build/_shared/chunk-H33OI7YH.js";import{a as p}from"/build/_shared/chunk-JBQJJPFB.js";import{b as s}from"/build/_shared/chunk-SS7AQOQ3.js";import{a as $,b as J,c as G}from"/build/_shared/chunk-2MHSPA7K.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as m}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-XNZ6DBKW.js";import"/build/_shared/chunk-YYMCCM4Y.js";import{a as Ne}from"/build/_shared/chunk-35S5HMBT.js";import"/build/_shared/chunk-2BPW44Z6.js";import"/build/_shared/chunk-5KYGR3MA.js";import"/build/_shared/chunk-KLKNQD3Q.js";import"/build/_shared/chunk-PGURRWG5.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as fe}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as b,b as T,c as B,e as j}from"/build/_shared/chunk-G5A27C7O.js";import{h as l}from"/build/_shared/chunk-NVGVVEPD.js";import{Ea as x,X as O,b as R,oa as y,t as M}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as E,i as L,k,l as F,p as I,q as U}from"/build/_shared/chunk-GTSSQFHM.js";import{a as ge,b as P}from"/build/_shared/chunk-BBTKOQ57.js";import{e as c}from"/build/_shared/chunk-UED2Q7CE.js";var i=c(ge()),be=c(Ne());var ye=c(ve()),xe=c(fe());var we=c(he());var e=c(P());function X(){let{user:r,users:Y,accesses:Z,can:_}=I(),w=U(),D=E(),[C,ee]=(0,i.useState)(!1),[S,te]=(0,i.useState)(r.avatar),[ae,se]=(0,i.useState)(!1),[g,re]=(0,i.useState)(r.avatar?[r.avatar]:[]),[A,ie]=(0,i.useState)(r.supervisors.map(t=>t.id)),[d,f]=(0,i.useState)(r.payroll?.earnings||[]),[u,v]=(0,i.useState)(r.payroll?.deductions||[]),oe=t=>{ie(a=>a.includes(t)?a.filter(o=>o!==t):[...a,t])},ne=t=>{re(t),g.length>0&&te(g[0])},ce=L(),le=t=>{t.preventDefault(),ee(!0);let a=new FormData(t.currentTarget);g.forEach(o=>{a.append("attachments",o.id)}),a.append("payroll",JSON.stringify({earnings:d,deductions:u})),ce(a,{method:"post"})},me=()=>{let t={id:crypto.randomUUID(),description:"",amount:0,isPercentage:!1};f([...d,t])},de=()=>{let t={id:crypto.randomUUID(),description:"",amount:0,isPercentage:!1};v([...u,t])},N=(t,a,o)=>{f(d.map(n=>n.id===t?{...n,[a]:o}:n))},h=(t,a,o)=>{v(u.map(n=>n.id===t?{...n,[a]:o}:n))},ue=t=>{f(d.filter(a=>a.id!==t))},pe=t=>{v(u.filter(a=>a.id!==t))};return(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 max-w-3xl",children:[_?.list&&(0,e.jsx)(l,{asChild:!0,variant:"outline",className:"mb-6 h-12 text-base",children:(0,e.jsxs)(k,{prefetch:"intent",to:"/o/users",children:[(0,e.jsx)(R,{className:"mr-2 h-5 w-5"}),"Retour \xE0 la liste"]})}),(0,e.jsxs)(b,{children:[(0,e.jsx)(T,{className:"p-4 sm:p-6",children:(0,e.jsx)(B,{className:"text-2xl sm:text-3xl font-bold",children:"Modifier l'Utilisateur"})}),(0,e.jsxs)(j,{className:"p-4 sm:p-6 space-y-6",children:[w?.error&&(0,e.jsxs)($,{variant:"destructive",children:[(0,e.jsx)(M,{className:"h-5 w-5"}),(0,e.jsx)(J,{className:"text-base font-medium",children:"Erreur"}),(0,e.jsx)(G,{className:"text-base",children:w.error})]}),(0,e.jsxs)(F,{method:"post",onSubmit:le,children:[(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(s,{htmlFor:"attachments",className:"text-base font-medium text-center block",children:"Avatar (Photo de Profile)"}),(0,e.jsx)(K,{onSelect:ne,defaultSelectedDocuments:S?[S]:[],multiple:!1,accept:"image/*",maxSize:5*1024*1024,onBusyStateChange:se,isAvatar:!0})]}),(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(s,{htmlFor:"firstName",className:"text-base font-medium",children:"Pr\xE9nom"}),(0,e.jsx)(m,{type:"text",id:"firstName",name:"firstName",defaultValue:r.firstName,required:!0,className:"h-12 text-base"})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(s,{htmlFor:"lastName",className:"text-base font-medium",children:"Nom"}),(0,e.jsx)(m,{type:"text",id:"lastName",name:"lastName",defaultValue:r.lastName,required:!0,className:"h-12 text-base"})]})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(s,{htmlFor:"access",className:"text-base font-medium",children:"Droit d'Acc\xE8s"}),(0,e.jsxs)(z,{name:"access",defaultValue:r.access?.id,children:[(0,e.jsx)(V,{className:"h-12 text-base",children:(0,e.jsx)(H,{placeholder:"S\xE9lectionnez un droit d'acc\xE8s"})}),(0,e.jsx)(q,{children:Z.map(t=>(0,e.jsx)(W,{value:t.id,className:"text-base",children:t.name},t.id))})]})]}),(0,e.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,e.jsx)(s,{className:"text-base font-medium",children:"Modifier ses superviseurs"}),(0,e.jsx)(b,{children:(0,e.jsx)(Q,{className:"h-72 sm:h-80 w-full rounded-md border p-4",children:Y.map(t=>(0,e.jsxs)("div",{className:"flex items-center space-x-3 py-3 sm:py-4",children:[(0,e.jsx)(p,{id:`user-${t.id}`,checked:A.includes(t.id),onCheckedChange:()=>oe(t.id),className:"h-5 w-5 sm:h-6 sm:w-6"}),(0,e.jsxs)("label",{htmlFor:`user-${t.id}`,className:"text-base font-medium cursor-pointer",children:[t.firstName," ",t.lastName]}),A.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"supervisors",value:t.id})]},t.id))})})]}),(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)(s,{className:"text-base font-medium",children:"Revenus"}),d.map(t=>(0,e.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,e.jsx)(m,{type:"text",placeholder:"Description",value:t.description,onChange:a=>N(t.id,"description",a.target.value),className:"flex-1"}),(0,e.jsx)(m,{type:"number",placeholder:"Montant",value:t.amount,onChange:a=>N(t.id,"amount",parseFloat(a.target.value)),className:"w-32"}),(0,e.jsx)(p,{checked:t.isPercentage,onCheckedChange:a=>N(t.id,"isPercentage",!!a)}),(0,e.jsx)(s,{className:"text-sm",children:"%"}),(0,e.jsx)(l,{type:"button",variant:"ghost",size:"icon",onClick:()=>ue(t.id),children:(0,e.jsx)(x,{className:"h-4 w-4"})})]},t.id)),(0,e.jsxs)(l,{type:"button",variant:"outline",onClick:me,className:"w-full",children:[(0,e.jsx)(y,{className:"mr-2 h-4 w-4"}),"Ajouter un revenu"]})]}),(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)(s,{className:"text-base font-medium",children:"D\xE9ductions"}),u.map(t=>(0,e.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,e.jsx)(m,{type:"text",placeholder:"Description",value:t.description,onChange:a=>h(t.id,"description",a.target.value),className:"flex-1"}),(0,e.jsx)(m,{type:"number",placeholder:"Montant",value:t.amount,onChange:a=>h(t.id,"amount",parseFloat(a.target.value)),className:"w-32"}),(0,e.jsx)(p,{checked:t.isPercentage,onCheckedChange:a=>h(t.id,"isPercentage",!!a)}),(0,e.jsx)(s,{className:"text-sm",children:"%"}),(0,e.jsx)(l,{type:"button",variant:"ghost",size:"icon",onClick:()=>pe(t.id),children:(0,e.jsx)(x,{className:"h-4 w-4"})})]},t.id)),(0,e.jsxs)(l,{type:"button",variant:"outline",onClick:de,className:"w-full",children:[(0,e.jsx)(y,{className:"mr-2 h-4 w-4"}),"Ajouter une d\xE9duction"]})]})]}),(0,e.jsx)(l,{type:"submit",className:"w-full h-12 text-base",disabled:C||ae||D.state==="submitting",children:C||D.state==="submitting"?(0,e.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,e.jsx)(O,{className:"h-5 w-5 animate-spin"}),"Mise \xE0 jour..."]}):"Mettre \xE0 jour l'utilisateur"})]})]})]})]})]})}export{X as default};
