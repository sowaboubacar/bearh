import{a as Q}from"/build/_shared/chunk-KOQ6QM7E.js";import{a as j}from"/build/_shared/chunk-A762UFCP.js";import"/build/_shared/chunk-RHTBOEYQ.js";import"/build/_shared/chunk-HNF2M344.js";import"/build/_shared/chunk-IQV4D3C7.js";import"/build/_shared/chunk-H33OI7YH.js";import"/build/_shared/chunk-JBQJJPFB.js";import{b as i}from"/build/_shared/chunk-SS7AQOQ3.js";import{a as T,b as k,c as $}from"/build/_shared/chunk-2MHSPA7K.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as l}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-XNZ6DBKW.js";import"/build/_shared/chunk-YYMCCM4Y.js";import{a as V}from"/build/_shared/chunk-35S5HMBT.js";import"/build/_shared/chunk-2BPW44Z6.js";import"/build/_shared/chunk-5KYGR3MA.js";import"/build/_shared/chunk-KLKNQD3Q.js";import"/build/_shared/chunk-PGURRWG5.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as K}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as C,b as D,c as A,e as S,f as F}from"/build/_shared/chunk-G5A27C7O.js";import{h as n}from"/build/_shared/chunk-NVGVVEPD.js";import{Ea as B,X as L,b as I,oa as E,t as R}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as b,i as N,k as v,l as x,q as w}from"/build/_shared/chunk-GTSSQFHM.js";import{a as G,b as y}from"/build/_shared/chunk-BBTKOQ57.js";import{e as o}from"/build/_shared/chunk-UED2Q7CE.js";var m=o(G()),X=o(V());var Y=o(Q()),Z=o(K());var e=o(y());function U(){let u=w(),p=b(),[r,c]=(0,m.useState)([{description:"",amount:""}]),[d,H]=(0,m.useState)(!1),[f,O]=(0,m.useState)([]),P=N(),[W,q]=(0,m.useState)(!1),J=()=>{c([...r,{description:"",amount:""}])},M=a=>{c(r.filter((t,s)=>s!==a))},h=(a,t,s)=>{let g=[...r];g[a][t]=s,c(g)},z=a=>{H(!0),a.preventDefault();let t=new FormData(a.currentTarget);f.forEach(s=>{t.append("attachments",s.id)}),console.log("Selected doc before submit: ",f),P(t,{method:"post"})},_=a=>{console.log(a),O(t=>[...t,...a])};return(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:py-10",children:[(0,e.jsx)(n,{asChild:!0,variant:"outline",className:"mb-6 h-11 text-base",children:(0,e.jsxs)(v,{prefetch:"intent",to:"/o/expense-report",children:[(0,e.jsx)(I,{className:"mr-2 h-5 w-5"}),"Retour \xE0 la liste"]})}),(0,e.jsxs)(C,{className:"max-w-2xl mx-auto",children:[(0,e.jsx)(D,{className:"p-4 sm:p-6",children:(0,e.jsx)(A,{className:"text-xl sm:text-2xl lg:text-3xl font-bold",children:"Nouvelle note de frais"})}),(0,e.jsxs)(x,{method:"post",onSubmit:z,children:[(0,e.jsxs)(S,{className:"p-4 sm:p-6 space-y-6",children:[u?.error&&(0,e.jsxs)(T,{variant:"destructive",children:[(0,e.jsx)(R,{className:"h-5 w-5"}),(0,e.jsx)(k,{className:"text-base font-medium",children:"Erreur"}),(0,e.jsx)($,{className:"text-base",children:u.error})]}),r.map((a,t)=>(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 sm:items-end",children:[(0,e.jsxs)("div",{className:"flex-grow space-y-2",children:[(0,e.jsx)(i,{htmlFor:`description-${t}`,className:"text-base font-medium",children:"Description"}),(0,e.jsx)(l,{id:`description-${t}`,value:a.description,onChange:s=>h(t,"description",s.target.value),required:!0,className:"h-11 text-base"})]}),(0,e.jsxs)("div",{className:"w-full sm:w-1/4 space-y-2",children:[(0,e.jsx)(i,{htmlFor:`amount-${t}`,className:"text-base font-medium",children:"Montant"}),(0,e.jsx)(l,{id:`amount-${t}`,type:"number",step:"0.01",value:a.amount,onChange:s=>h(t,"amount",s.target.value),required:!0,className:"h-11 text-base"})]}),(0,e.jsx)(n,{type:"button",variant:"outline",onClick:()=>M(t),className:"h-11 w-11",children:(0,e.jsx)(B,{className:"h-5 w-5"})})]},t)),(0,e.jsxs)(n,{type:"button",onClick:J,className:"w-full h-11 text-base",children:[(0,e.jsx)(E,{className:"mr-2 h-5 w-5"}),"Ajouter un \xE9l\xE9ment"]}),(0,e.jsx)("input",{type:"hidden",name:"items",value:JSON.stringify(r)}),(0,e.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,e.jsx)(i,{htmlFor:"attachments",className:"text-base font-medium",children:"Images & Pi\xE8ces jointes"}),(0,e.jsx)(j,{onSelect:_,multiple:!0,accept:"image/*,application/pdf",maxSize:5*1024*1024,onBusyStateChange:q,className:"w-full"})]})]}),(0,e.jsx)(F,{className:"p-4 sm:p-6",children:(0,e.jsx)(n,{type:"submit",className:"w-full h-11 text-base",disabled:d||W||p.state==="submitting",children:d||p.state==="submitting"?(0,e.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,e.jsx)(L,{className:"h-5 w-5 animate-spin"}),"Cr\xE9ation en cours..."]}):"Cr\xE9er la note de frais"})})]})]})]})}export{U as default};
