import{a as b}from"/build/_shared/chunk-W7OEIS22.js";import{a as xe}from"/build/_shared/chunk-M3SJMO64.js";import{a as fe}from"/build/_shared/chunk-YWUCPBEQ.js";import{a as ge}from"/build/_shared/chunk-XSP4JB6A.js";import{a as be}from"/build/_shared/chunk-XKJ5LF2E.js";import{a as he}from"/build/_shared/chunk-CP3WB6KC.js";import{a as Ne}from"/build/_shared/chunk-3DB3GQTY.js";import{a as m}from"/build/_shared/chunk-XDNDK56N.js";import{a as H,b as M,c as U,d as j,e as f}from"/build/_shared/chunk-NCY4KUS2.js";import"/build/_shared/chunk-Q6K63OHD.js";import"/build/_shared/chunk-KAUQO2FD.js";import"/build/_shared/chunk-7ZNTUDLC.js";import{a as ue}from"/build/_shared/chunk-6JFOYO3V.js";import{a as R}from"/build/_shared/chunk-L2TBXS32.js";import{a as V}from"/build/_shared/chunk-A762UFCP.js";import"/build/_shared/chunk-RHTBOEYQ.js";import"/build/_shared/chunk-HNF2M344.js";import"/build/_shared/chunk-IQV4D3C7.js";import"/build/_shared/chunk-H33OI7YH.js";import{a as d}from"/build/_shared/chunk-JBQJJPFB.js";import{b as r}from"/build/_shared/chunk-SS7AQOQ3.js";import{a as G,b as B,c as q}from"/build/_shared/chunk-2MHSPA7K.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as $}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-XNZ6DBKW.js";import"/build/_shared/chunk-YYMCCM4Y.js";import{a as pe}from"/build/_shared/chunk-35S5HMBT.js";import"/build/_shared/chunk-2BPW44Z6.js";import"/build/_shared/chunk-5KYGR3MA.js";import"/build/_shared/chunk-KLKNQD3Q.js";import"/build/_shared/chunk-PGURRWG5.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as me}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as c,b as n,c as l,e as o,f as L}from"/build/_shared/chunk-G5A27C7O.js";import{h as g}from"/build/_shared/chunk-NVGVVEPD.js";import{X as I,b as P,t as E}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as w,i as A,k as S,l as k,p as F,q as T}from"/build/_shared/chunk-GTSSQFHM.js";import{a as de,b as D}from"/build/_shared/chunk-BBTKOQ57.js";import{e as s}from"/build/_shared/chunk-UED2Q7CE.js";var N=s(de()),Ce=s(pe());var ve=s(xe()),ye=s(ue()),we=s(ge()),Ae=s(he()),Se=s(be()),ke=s(Ne()),Fe=s(fe()),Te=s(me());var e=s(D());function W(){let{news:i,users:z,teams:O,departments:J,positions:K,hourGroups:Q,accesses:X,can:Y}=F(),[Z,_]=(0,N.useState)(i.attachments),x=T(),C=w(),[v,ee]=(0,N.useState)(!1),[y,te]=(0,N.useState)(i.isPublic),[a,ae]=(0,N.useState)(i.targetAudience||{users:[],positions:[],teams:[],departments:[],hourGroups:[],access:[]}),[se,ie]=(0,N.useState)(!1),re=A(),ce=t=>{ee(!0),t.preventDefault();let p=new FormData(t.currentTarget);Z.forEach(h=>{p.append("attachments",h.id)}),re(p,{method:"post"})},ne=t=>{_(t)},u=(t,p)=>{ae(h=>{let le=h[t].includes(p)?h[t].filter(oe=>oe!==p):[...h[t],p];return{...h,[t]:le}})};return(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8",children:[Y?.list&&(0,e.jsx)(g,{asChild:!0,variant:"outline",className:"mb-6 h-12 text-base",children:(0,e.jsxs)(S,{prefetch:"intent",to:"/o/news",children:[(0,e.jsx)(P,{className:"mr-2 h-5 w-5"}),"Retour \xE0 la liste"]})}),(0,e.jsxs)(c,{className:"max-w-4xl mx-auto",children:[(0,e.jsx)(n,{className:"p-4 sm:p-6",children:(0,e.jsx)(l,{className:"text-xl sm:text-2xl lg:text-3xl font-bold",children:"Modifier l'Actualit\xE9"})}),(0,e.jsxs)(k,{method:"post",onSubmit:ce,children:[(0,e.jsxs)(o,{className:"p-4 sm:p-6 space-y-6",children:[x?.error&&(0,e.jsxs)(G,{variant:"destructive",children:[(0,e.jsx)(E,{className:"h-5 w-5"}),(0,e.jsx)(B,{className:"text-base font-medium",children:"Erreur"}),(0,e.jsx)(q,{className:"text-base",children:x.error})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(r,{htmlFor:"title",className:"text-base font-medium",children:"Titre"}),(0,e.jsx)($,{id:"title",name:"title",defaultValue:i.title,required:!0,className:"h-12 text-base"})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(r,{htmlFor:"content",className:"text-base font-medium",children:"Contenu"}),(0,e.jsx)(R,{id:"content",name:"content",defaultValue:i.content,required:!0,className:"min-h-[150px] text-base p-3"})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(r,{htmlFor:"type",className:"text-base font-medium",children:"Type"}),(0,e.jsxs)(H,{name:"type",defaultValue:i.type,required:!0,children:[(0,e.jsx)(U,{className:"h-12 text-base",children:(0,e.jsx)(M,{placeholder:"S\xE9lectionnez un type"})}),(0,e.jsxs)(j,{children:[(0,e.jsx)(f,{value:"Announcement",className:"text-base",children:"Annonce"}),(0,e.jsx)(f,{value:"Event",className:"text-base",children:"\xC9v\xE9nement"})]})]})]}),(0,e.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 max-w-2xl mx-auto w-full p-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(b,{id:"isPublished",name:"isPublished",defaultChecked:i.isPublished,className:"h-5 w-10 sm:h-6 sm:w-11"}),(0,e.jsx)(r,{htmlFor:"isPublished",className:"text-sm sm:text-base font-medium truncate",children:"Publier imm\xE9diatement"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(b,{id:"isEmergency",name:"isEmergency",defaultChecked:i.isEmergency,className:"h-5 w-10 sm:h-6 sm:w-11"}),(0,e.jsx)(r,{htmlFor:"isEmergency",className:"text-sm sm:text-base font-medium",children:"Urgent"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)(b,{id:"isPublic",name:"isPublic",checked:y,onCheckedChange:te,className:"h-5 w-10 sm:h-6 sm:w-11"}),(0,e.jsx)(r,{htmlFor:"isPublic",className:"text-sm sm:text-base font-medium",children:"Public"})]})]}),!y&&(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)(r,{className:"text-base font-medium",children:"Public cible"}),(0,e.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,e.jsxs)(c,{className:"shadow-none border",children:[(0,e.jsx)(n,{className:"p-4",children:(0,e.jsx)(l,{className:"text-base font-semibold",children:"Utilisateurs"})}),(0,e.jsx)(o,{className:"p-0",children:(0,e.jsx)(m,{className:"h-48 px-4",children:z.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,e.jsx)(d,{id:`user-${t.id}`,checked:a.users.includes(t.id),onCheckedChange:()=>u("users",t.id),className:"h-5 w-5"}),(0,e.jsxs)("label",{htmlFor:`user-${t.id}`,className:"text-base",children:[t.firstName," ",t.lastName]}),a.users.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"targetAudience.users",value:t.id})]},t.id))})})]}),(0,e.jsxs)(c,{className:"shadow-none border",children:[(0,e.jsx)(n,{className:"p-4",children:(0,e.jsx)(l,{className:"text-base font-semibold",children:"Postes"})}),(0,e.jsx)(o,{className:"p-0",children:(0,e.jsx)(m,{className:"h-48 px-4",children:K.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,e.jsx)(d,{id:`position-${t.id}`,checked:a.positions.includes(t.id),onCheckedChange:()=>u("positions",t.id),className:"h-5 w-5"}),(0,e.jsx)("label",{htmlFor:`position-${t.id}`,className:"text-base",children:t.title}),a.positions.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"targetAudience.positions",value:t.id})]},t.id))})})]}),(0,e.jsxs)(c,{className:"shadow-none border",children:[(0,e.jsx)(n,{className:"p-4",children:(0,e.jsx)(l,{className:"text-base font-semibold",children:"\xC9quipes"})}),(0,e.jsx)(o,{className:"p-0",children:(0,e.jsx)(m,{className:"h-48 px-4",children:O.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,e.jsx)(d,{id:`team-${t.id}`,checked:a.teams.includes(t.id),onCheckedChange:()=>u("teams",t.id),className:"h-5 w-5"}),(0,e.jsx)("label",{htmlFor:`team-${t.id}`,className:"text-base",children:t.name}),a.teams.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"targetAudience.teams",value:t.id})]},t.id))})})]}),(0,e.jsxs)(c,{className:"shadow-none border",children:[(0,e.jsx)(n,{className:"p-4",children:(0,e.jsx)(l,{className:"text-base font-semibold",children:"D\xE9partements"})}),(0,e.jsx)(o,{className:"p-0",children:(0,e.jsx)(m,{className:"h-48 px-4",children:J.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,e.jsx)(d,{id:`department-${t.id}`,checked:a.departments.includes(t.id),onCheckedChange:()=>u("departments",t.id),className:"h-5 w-5"}),(0,e.jsx)("label",{htmlFor:`department-${t.id}`,className:"text-base",children:t.name}),a.departments.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"targetAudience.departments",value:t.id})]},t.id))})})]}),(0,e.jsxs)(c,{className:"shadow-none border",children:[(0,e.jsx)(n,{className:"p-4",children:(0,e.jsx)(l,{className:"text-base font-semibold",children:"Groupes Horaires"})}),(0,e.jsx)(o,{className:"p-0",children:(0,e.jsx)(m,{className:"h-48 px-4",children:Q.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,e.jsx)(d,{id:`hourGroup-${t.id}`,checked:a.hourGroups.includes(t.id),onCheckedChange:()=>u("hourGroups",t.id),className:"h-5 w-5"}),(0,e.jsx)("label",{htmlFor:`hourGroup-${t.id}`,className:"text-base",children:t.name}),a.hourGroups.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"targetAudience.hourGroups",value:t.id})]},t.id))})})]}),(0,e.jsxs)(c,{className:"shadow-none border",children:[(0,e.jsx)(n,{className:"p-4",children:(0,e.jsx)(l,{className:"text-base font-semibold",children:"Groupes d'Acc\xE8s"})}),(0,e.jsx)(o,{className:"p-0",children:(0,e.jsx)(m,{className:"h-48 px-4",children:X.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,e.jsx)(d,{id:`access-${t.id}`,checked:a.access.includes(t.id),onCheckedChange:()=>u("access",t.id),className:"h-5 w-5"}),(0,e.jsx)("label",{htmlFor:`access-${t.id}`,className:"text-base",children:t.name}),a.access.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"targetAudience.access",value:t.id})]},t.id))})})]})]})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(r,{htmlFor:"attachments",className:"text-base font-medium",children:"Images & Pi\xE8ces jointes"}),(0,e.jsx)(V,{onSelect:ne,defaultSelectedDocuments:i.attachments,multiple:!0,accept:"image/*,application/pdf",maxSize:5*1024*1024,onBusyStateChange:ie})]})]}),(0,e.jsx)(L,{className:"p-4 sm:p-6",children:(0,e.jsx)(g,{type:"submit",className:"w-full h-12 text-base",disabled:v||se||C.state==="submitting",children:v||C.state==="submitting"?(0,e.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,e.jsx)(I,{className:"h-5 w-5 animate-spin"}),"Mise \xE0 jour en cours..."]}):"Mettre \xE0 jour l'actualit\xE9"})})]})]})]})}export{W as default};
