import{a as de}from"/build/_shared/chunk-YWUCPBEQ.js";import{a as le}from"/build/_shared/chunk-XKJ5LF2E.js";import{a as W}from"/build/_shared/chunk-XDNDK56N.js";import{a as T,b as E,c as P,d as R,e as M}from"/build/_shared/chunk-NCY4KUS2.js";import"/build/_shared/chunk-Q6K63OHD.js";import"/build/_shared/chunk-KAUQO2FD.js";import"/build/_shared/chunk-7ZNTUDLC.js";import{a as ce}from"/build/_shared/chunk-6JFOYO3V.js";import{a as j}from"/build/_shared/chunk-L2TBXS32.js";import{a as H}from"/build/_shared/chunk-A762UFCP.js";import"/build/_shared/chunk-RHTBOEYQ.js";import"/build/_shared/chunk-HNF2M344.js";import"/build/_shared/chunk-IQV4D3C7.js";import"/build/_shared/chunk-H33OI7YH.js";import{a as B}from"/build/_shared/chunk-JBQJJPFB.js";import{b as i}from"/build/_shared/chunk-SS7AQOQ3.js";import{a as I,b as U,c as k}from"/build/_shared/chunk-2MHSPA7K.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as L}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-XNZ6DBKW.js";import"/build/_shared/chunk-YYMCCM4Y.js";import{a as me}from"/build/_shared/chunk-35S5HMBT.js";import"/build/_shared/chunk-2BPW44Z6.js";import"/build/_shared/chunk-5KYGR3MA.js";import"/build/_shared/chunk-KLKNQD3Q.js";import"/build/_shared/chunk-PGURRWG5.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as ne}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as c,b as y,c as S,e as C,f as w}from"/build/_shared/chunk-G5A27C7O.js";import{h as m}from"/build/_shared/chunk-NVGVVEPD.js";import{X as F,b as D,t as A}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as f,i as b,k as g,l as h,p as N,q as v}from"/build/_shared/chunk-GTSSQFHM.js";import{a as ie,b as x}from"/build/_shared/chunk-BBTKOQ57.js";import{e as o}from"/build/_shared/chunk-UED2Q7CE.js";var pe=o(me());var a=o(ie());var ue=o(le()),fe=o(de()),be=o(ne());var ge=o(ce());var e=o(x());function $(){let{position:s,accesses:q,users:z,can:O}=N(),l=v(),V=f(),[G,J]=(0,a.useState)(s.title),[K,Q]=(0,a.useState)(s.description||""),[X,d]=(0,a.useState)(s.access?.id||""),p=V.state==="submitting",[Y,Z]=(0,a.useState)(s.attachments),[_,ee]=(0,a.useState)(!1),te=b(),se=t=>{t.preventDefault();let r=new FormData(t.currentTarget);Y.forEach(n=>{r.append("attachments",n.id)}),te(r,{method:"post"})},ae=t=>{Z(t)},[u,oe]=(0,a.useState)(s.members.map(t=>t.id)),re=t=>{oe(r=>r.includes(t)?r.filter(n=>n!==t):[...r,t])};return(0,a.useEffect)(()=>{s.access&&d(s.access.id)},[s.access]),(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8",children:[O?.list&&(0,e.jsx)(m,{asChild:!0,variant:"outline",className:"mb-6 h-12 text-base",children:(0,e.jsxs)(g,{prefetch:"intent",to:"/o/positions",children:[(0,e.jsx)(D,{className:"mr-2 h-5 w-5"}),"Retour \xE0 la liste"]})}),(0,e.jsxs)(c,{className:"max-w-2xl mx-auto",children:[(0,e.jsx)(y,{className:"p-4 sm:p-6",children:(0,e.jsx)(S,{className:"text-2xl sm:text-3xl font-bold",children:"Modifier le Poste"})}),(0,e.jsxs)(h,{method:"post",onSubmit:se,children:[(0,e.jsxs)(C,{className:"p-4 sm:p-6 space-y-6",children:[l?.error&&(0,e.jsxs)(I,{variant:"destructive",children:[(0,e.jsx)(A,{className:"h-5 w-5"}),(0,e.jsx)(U,{className:"text-base font-medium",children:"Erreur"}),(0,e.jsx)(k,{className:"text-base",children:l.error})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(i,{htmlFor:"title",className:"text-base font-medium",children:"Titre du poste"}),(0,e.jsx)(L,{id:"title",name:"title",value:G,onChange:t=>J(t.target.value),required:!0,className:"h-12 text-base"})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(i,{htmlFor:"description",className:"text-base font-medium",children:"Description"}),(0,e.jsx)(j,{id:"description",name:"description",value:K,onChange:t=>Q(t.target.value),rows:4,className:"min-h-[120px] text-base p-3 resize-y"})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(i,{htmlFor:"access",className:"text-base font-medium",children:"Droit d'acc\xE8s"}),(0,e.jsxs)(T,{name:"access",value:X,onValueChange:d,children:[(0,e.jsx)(P,{className:"h-12 text-base",children:(0,e.jsx)(E,{placeholder:"S\xE9lectionner un droit d'acc\xE8s"})}),(0,e.jsx)(R,{children:q.map(t=>(0,e.jsx)(M,{value:t.id,className:"text-base",children:t.name},t.id))})]})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(i,{className:"text-base font-medium",children:"Membres de la fiche de Poste"}),(0,e.jsx)(c,{children:(0,e.jsx)(W,{className:"h-[300px] w-full rounded-md border p-4",children:z.map(t=>(0,e.jsxs)("div",{className:"flex items-center space-x-3 py-3 border-b last:border-0",children:[(0,e.jsx)(B,{id:`user-${t.id}`,checked:u.includes(t.id),onCheckedChange:()=>re(t.id),className:"h-5 w-5"}),(0,e.jsxs)("label",{htmlFor:`user-${t.id}`,className:"text-base font-medium",children:[t.firstName," ",t.lastName]}),u.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"members",value:t.id})]},t.id))})})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(i,{htmlFor:"attachments",className:"text-base font-medium",children:"Images & Pi\xE8ces jointes"}),(0,e.jsx)(H,{onSelect:ae,defaultSelectedDocuments:s.attachments,multiple:!0,accept:"image/*,application/pdf",maxSize:5*1024*1024,onBusyStateChange:ee})]})]}),(0,e.jsx)(w,{className:"p-4 sm:p-6",children:(0,e.jsx)(m,{type:"submit",className:"w-full h-12 text-base",disabled:p||_,children:p?(0,e.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,e.jsx)(F,{className:"h-5 w-5 animate-spin"}),"Mise \xE0 jour en cours..."]}):"Mettre \xE0 jour le Poste"})})]})]})]})}export{$ as default};
