import{a as Ne}from"/build/_shared/chunk-YWUCPBEQ.js";import{a as he}from"/build/_shared/chunk-CXU4QXE4.js";import{a as pe}from"/build/_shared/chunk-XSP4JB6A.js";import{a as ue}from"/build/_shared/chunk-XKJ5LF2E.js";import{a as ce}from"/build/_shared/chunk-CP3WB6KC.js";import{a as me}from"/build/_shared/chunk-3DB3GQTY.js";import{a as m}from"/build/_shared/chunk-XDNDK56N.js";import{a as v,b as C,c as x,d as y,e as b}from"/build/_shared/chunk-NCY4KUS2.js";import"/build/_shared/chunk-Q6K63OHD.js";import"/build/_shared/chunk-KAUQO2FD.js";import"/build/_shared/chunk-7ZNTUDLC.js";import{a as de}from"/build/_shared/chunk-6JFOYO3V.js";import{a as j}from"/build/_shared/chunk-L2TBXS32.js";import{a as V}from"/build/_shared/chunk-A762UFCP.js";import"/build/_shared/chunk-RHTBOEYQ.js";import"/build/_shared/chunk-HNF2M344.js";import"/build/_shared/chunk-IQV4D3C7.js";import"/build/_shared/chunk-H33OI7YH.js";import{a as c}from"/build/_shared/chunk-JBQJJPFB.js";import{b as l}from"/build/_shared/chunk-SS7AQOQ3.js";import{a as P,b as U,c as O}from"/build/_shared/chunk-2MHSPA7K.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as R}from"/build/_shared/chunk-WZRQ3RQI.js";import"/build/_shared/chunk-XNZ6DBKW.js";import"/build/_shared/chunk-YYMCCM4Y.js";import{a as le}from"/build/_shared/chunk-35S5HMBT.js";import"/build/_shared/chunk-2BPW44Z6.js";import"/build/_shared/chunk-5KYGR3MA.js";import"/build/_shared/chunk-KLKNQD3Q.js";import"/build/_shared/chunk-PGURRWG5.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as ne}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as r,b as o,c as n,e as d,f as $}from"/build/_shared/chunk-G5A27C7O.js";import{h as g}from"/build/_shared/chunk-NVGVVEPD.js";import{X as M,b as G,t as H}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as F,i as k,k as D,l as E,p as L,q as T}from"/build/_shared/chunk-GTSSQFHM.js";import{a as oe,b as I}from"/build/_shared/chunk-BBTKOQ57.js";import{e as i}from"/build/_shared/chunk-UED2Q7CE.js";var u=i(oe()),be=i(le());var fe=i(he()),ge=i(de()),ve=i(ue()),Ce=i(pe()),xe=i(ce()),ye=i(me()),Se=i(Ne()),we=i(ne());var e=i(I());function q(){let{note:a,users:S,positions:B,teams:z,departments:J,hourGroups:K,access:Q,can:X}=L(),w=T(),f=F(),[Y,A]=(0,u.useState)(a.visibility),[s,Z]=(0,u.useState)({users:a.sharedWith?.users?.map(t=>t.id)||[],positions:a.sharedWith?.positions?.map(t=>t.id)||[],teams:a.sharedWith?.teams?.map(t=>t.id)||[],departments:a.sharedWith?.departments?.map(t=>t.id)||[],hourGroups:a.sharedWith?.hourGroups?.map(t=>t.id)||[],access:a.sharedWith?.access?.map(t=>t.id)||[]}),W=f.state==="submitting",[_,ee]=(0,u.useState)(a.attachments),[Ae,te]=(0,u.useState)(!1),ae=k(),se=t=>{t.preventDefault();let p=new FormData(t.currentTarget);_.forEach(N=>{p.append("attachments",N.id)}),ae(p,{method:"post"})},ie=t=>{ee(t)},h=(t,p)=>{Z(N=>({...N,[t]:N[t].includes(p)?N[t].filter(re=>re!==p):[...N[t],p]}))};return(0,u.useEffect)(()=>{A(a.visibility)},[a]),(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8",children:[X?.list&&(0,e.jsx)(g,{asChild:!0,variant:"outline",className:"mb-6 h-12 text-base",children:(0,e.jsxs)(D,{prefetch:"intent",to:"/o/note",children:[(0,e.jsx)(G,{className:"mr-2 h-5 w-5"}),"Retour \xE0 la liste"]})}),(0,e.jsxs)(r,{className:"max-w-2xl mx-auto",children:[(0,e.jsx)(o,{className:"p-4 sm:p-6",children:(0,e.jsx)(n,{className:"text-xl sm:text-2xl lg:text-3xl font-bold",children:"Modifier la Note"})}),(0,e.jsxs)(E,{method:"post",onSubmit:se,children:[(0,e.jsxs)(d,{className:"p-4 sm:p-6 space-y-6",children:[w?.message&&(0,e.jsxs)(P,{variant:"destructive",children:[(0,e.jsx)(H,{className:"h-5 w-5"}),(0,e.jsx)(U,{className:"text-base font-medium",children:"Erreur"}),(0,e.jsx)(O,{className:"text-base",children:w.message})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(l,{htmlFor:"title",className:"text-base font-medium",children:"Titre"}),(0,e.jsx)(R,{id:"title",name:"title",defaultValue:a.title,required:!0,className:"h-12 text-base"})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(l,{htmlFor:"content",className:"text-base font-medium",children:"Contenu"}),(0,e.jsx)(j,{id:"content",name:"content",defaultValue:a.content,required:!0,className:"min-h-[150px] text-base p-3"})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(l,{htmlFor:"author",className:"text-base font-medium",children:"Auteur"}),(0,e.jsxs)(v,{name:"author",defaultValue:a.author.id,required:!0,children:[(0,e.jsx)(x,{className:"h-12 text-base",children:(0,e.jsx)(C,{placeholder:"S\xE9lectionnez un auteur"})}),(0,e.jsx)(y,{children:S.map(t=>(0,e.jsxs)(b,{value:t.id,className:"text-base",children:[t.firstName," ",t.lastName]},t.id))})]})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(l,{htmlFor:"visibility",className:"text-base font-medium",children:"Visibilit\xE9"}),(0,e.jsxs)(v,{name:"visibility",defaultValue:a.visibility,onValueChange:A,required:!0,children:[(0,e.jsx)(x,{className:"h-12 text-base",children:(0,e.jsx)(C,{placeholder:"S\xE9lectionnez la visibilit\xE9"})}),(0,e.jsxs)(y,{children:[(0,e.jsx)(b,{value:"Private",className:"text-base",children:"Priv\xE9e"}),(0,e.jsx)(b,{value:"Public",className:"text-base",children:"Publique"}),(0,e.jsx)(b,{value:"Shared",className:"text-base",children:"Partag\xE9e"})]})]})]}),Y==="Shared"&&(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsx)(l,{className:"text-base font-medium",children:"Partag\xE9e avec"}),(0,e.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,e.jsxs)(r,{className:"shadow-none border",children:[(0,e.jsx)(o,{className:"p-4",children:(0,e.jsx)(n,{className:"text-base font-semibold",children:"Utilisateurs"})}),(0,e.jsx)(d,{className:"p-0",children:(0,e.jsx)(m,{className:"h-48 px-4",children:S.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,e.jsx)(c,{id:`user-${t.id}`,checked:s.users.includes(t.id),onCheckedChange:()=>h("users",t.id),className:"h-5 w-5"}),(0,e.jsxs)("label",{htmlFor:`user-${t.id}`,className:"text-base",children:[t.firstName," ",t.lastName]}),s.users.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"sharedWith.users",value:t.id})]},t.id))})})]}),(0,e.jsxs)(r,{className:"shadow-none border",children:[(0,e.jsx)(o,{className:"p-4",children:(0,e.jsx)(n,{className:"text-base font-semibold",children:"Postes"})}),(0,e.jsx)(d,{className:"p-0",children:(0,e.jsx)(m,{className:"h-48 px-4",children:B.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,e.jsx)(c,{id:`position-${t.id}`,checked:s.positions.includes(t.id),onCheckedChange:()=>h("positions",t.id),className:"h-5 w-5"}),(0,e.jsx)("label",{htmlFor:`position-${t.id}`,className:"text-base",children:t.title}),s.positions.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"sharedWith.positions",value:t.id})]},t.id))})})]}),(0,e.jsxs)(r,{className:"shadow-none border",children:[(0,e.jsx)(o,{className:"p-4",children:(0,e.jsx)(n,{className:"text-base font-semibold",children:"\xC9quipes"})}),(0,e.jsx)(d,{className:"p-0",children:(0,e.jsx)(m,{className:"h-48 px-4",children:z.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,e.jsx)(c,{id:`team-${t.id}`,checked:s.teams.includes(t.id),onCheckedChange:()=>h("teams",t.id),className:"h-5 w-5"}),(0,e.jsx)("label",{htmlFor:`team-${t.id}`,className:"text-base",children:t.name}),s.teams.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"sharedWith.teams",value:t.id})]},t.id))})})]}),(0,e.jsxs)(r,{className:"shadow-none border",children:[(0,e.jsx)(o,{className:"p-4",children:(0,e.jsx)(n,{className:"text-base font-semibold",children:"D\xE9partements"})}),(0,e.jsx)(d,{className:"p-0",children:(0,e.jsx)(m,{className:"h-48 px-4",children:J.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,e.jsx)(c,{id:`department-${t.id}`,checked:s.departments.includes(t.id),onCheckedChange:()=>h("departments",t.id),className:"h-5 w-5"}),(0,e.jsx)("label",{htmlFor:`department-${t.id}`,className:"text-base",children:t.name}),s.departments.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"sharedWith.departments",value:t.id})]},t.id))})})]}),(0,e.jsxs)(r,{className:"shadow-none border",children:[(0,e.jsx)(o,{className:"p-4",children:(0,e.jsx)(n,{className:"text-base font-semibold",children:"Groupes Horaires"})}),(0,e.jsx)(d,{className:"p-0",children:(0,e.jsx)(m,{className:"h-48 px-4",children:K.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,e.jsx)(c,{id:`hourGroup-${t.id}`,checked:s.hourGroups.includes(t.id),onCheckedChange:()=>h("hourGroups",t.id),className:"h-5 w-5"}),(0,e.jsx)("label",{htmlFor:`hourGroup-${t.id}`,className:"text-base",children:t.name}),s.hourGroups.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"sharedWith.hourGroups",value:t.id})]},t.id))})})]}),(0,e.jsxs)(r,{className:"shadow-none border",children:[(0,e.jsx)(o,{className:"p-4",children:(0,e.jsx)(n,{className:"text-base font-semibold",children:"Groupes d'Acc\xE8s"})}),(0,e.jsx)(d,{className:"p-0",children:(0,e.jsx)(m,{className:"h-48 px-4",children:Q.map(t=>(0,e.jsxs)("div",{className:"flex items-center gap-3 py-3",children:[(0,e.jsx)(c,{id:`access-${t.id}`,checked:s.access.includes(t.id),onCheckedChange:()=>h("access",t.id),className:"h-5 w-5"}),(0,e.jsx)("label",{htmlFor:`access-${t.id}`,className:"text-base",children:t.name}),s.access.includes(t.id)&&(0,e.jsx)("input",{type:"hidden",name:"sharedWith.access",value:t.id})]},t.id))})})]})]})]}),(0,e.jsxs)("div",{className:"space-y-3",children:[(0,e.jsx)(l,{htmlFor:"attachments",className:"text-base font-medium",children:"Images & Pi\xE8ces jointes"}),(0,e.jsx)(V,{onSelect:ie,defaultSelectedDocuments:a.attachments,multiple:!0,accept:"image/*,application/pdf",maxSize:5*1024*1024,onBusyStateChange:te})]})]}),(0,e.jsx)($,{className:"p-4 sm:p-6",children:(0,e.jsx)(g,{type:"submit",className:"w-full h-12 text-base",disabled:W||f.state==="submitting",children:W||f.state==="submitting"?(0,e.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,e.jsx)(M,{className:"h-5 w-5 animate-spin"}),"Mise \xE0 jour en cours..."]}):"Mettre \xE0 jour la note"})})]})]})]})}export{q as default};
