import{a as k}from"/build/_shared/chunk-6QXFNV75.js";import{a as he}from"/build/_shared/chunk-CXU4QXE4.js";import{a as Z,b as ae}from"/build/_shared/chunk-ABDDDOIB.js";import{a as _,b as ee,c as te,d as v,e as o,f as n}from"/build/_shared/chunk-IEDNE26R.js";import{a as se}from"/build/_shared/chunk-OFTXZR4P.js";import"/build/_shared/chunk-M3TRH43M.js";import{a as Y}from"/build/_shared/chunk-WZRQ3RQI.js";import{a as ge}from"/build/_shared/chunk-35S5HMBT.js";import{a as C,b as D,d as y,e as T,f as L,g as B,h as S}from"/build/_shared/chunk-KLKNQD3Q.js";import"/build/_shared/chunk-PGURRWG5.js";import"/build/_shared/chunk-AQWSFLPG.js";import"/build/_shared/chunk-GFAY22KF.js";import"/build/_shared/chunk-NGC74IU4.js";import"/build/_shared/chunk-WKQOSWRL.js";import"/build/_shared/chunk-Z5RMMUMH.js";import"/build/_shared/chunk-SUJVG5FV.js";import"/build/_shared/chunk-OMO5CWS2.js";import"/build/_shared/chunk-PVX4NJUU.js";import{a as pe}from"/build/_shared/chunk-B6OA2ZRE.js";import{a as W,b as q,c as G,e as z,f as J}from"/build/_shared/chunk-G5A27C7O.js";import{h as a}from"/build/_shared/chunk-NVGVVEPD.js";import{Ea as N,K as b,Q as K,W as Q,ra as X,xa as w}from"/build/_shared/chunk-PNJDYZ5P.js";import{e as j,h as O,k as p,l as U,p as V,r as I}from"/build/_shared/chunk-GTSSQFHM.js";import{a as ue,b as M}from"/build/_shared/chunk-BBTKOQ57.js";import{e as r}from"/build/_shared/chunk-UED2Q7CE.js";var s=r(ue()),fe=r(ge());var xe=r(he());var be=r(pe());var e=r(M());function ie(){let{notes:l,search:le,view:f,page:c,limit:x}=V(),[g,F]=(0,s.useState)(!1),[A,h]=O(),m=I(),re=j().state==="loading",[d,oe]=(0,s.useState)(f),[ne,ce]=(0,s.useState)(!1),[P,u]=(0,s.useState)(null);(0,s.useEffect)(()=>{ce(!0)},[]),(0,s.useEffect)(()=>{oe(A.get("view")||f)},[A,f]);let R=t=>{F(!0),m.submit({id:t,action:"delete"},{method:"post"}),u(null)};(0,s.useEffect)(()=>{m.state==="idle"&&m.data?.success&&F(!1)},[m.state,m.data]);let me=t=>{t.preventDefault();let de=new FormData(t.currentTarget).get("search");h(E=>(E.set("search",de),E))},H=t=>{h(i=>(i.set("view",t),i))},$=t=>t&&`${t.firstName||""} ${t.lastName||""}`.trim()||"Unknown Author";return ne?(0,e.jsxs)("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 space-y-6",children:[(0,e.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:(0,e.jsx)("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold",children:"Notes Partag\xE9s avec moi"})}),(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-4",children:[(0,e.jsxs)(U,{onSubmit:me,className:"flex items-center gap-2 w-full sm:w-auto sm:flex-1",children:[(0,e.jsx)(Y,{type:"search",name:"search",placeholder:"Rechercher des notes...",defaultValue:le,className:"h-12 text-base"}),(0,e.jsx)(a,{type:"submit",className:"h-12 w-12 flex-shrink-0",children:(0,e.jsx)(X,{className:"h-5 w-5"})})]}),(0,e.jsx)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)(a,{variant:d==="grid"?"default":"outline",onClick:()=>H("grid"),className:"flex-1 sm:flex-none h-12",children:(0,e.jsx)(K,{className:"h-5 w-5"})}),(0,e.jsx)(a,{variant:d==="list"?"default":"outline",onClick:()=>H("list"),className:"flex-1 sm:flex-none h-12",children:(0,e.jsx)(Q,{className:"h-5 w-5"})})]})})]}),re?(0,e.jsx)(ae,{view:d,itemCount:x}):l.results.length>0?d==="grid"?(0,e.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:l.results.map(t=>(0,e.jsxs)(W,{children:[(0,e.jsxs)(q,{className:"p-4 sm:p-6",children:[(0,e.jsx)(G,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:(0,e.jsx)("span",{className:"text-lg font-bold",children:t.title})}),(0,e.jsx)("div",{className:"aspect-video rounded-lg overflow-hidden",children:(0,e.jsx)("img",{src:k(t.attachments)?.file?.url,alt:k(t.attachments)?.label||"",className:"w-full h-full object-cover"})})]}),(0,e.jsxs)(z,{className:"p-4 sm:p-6 pt-0 space-y-3",children:[(0,e.jsx)("p",{className:"text-base text-muted-foreground line-clamp-2",children:t.content}),(0,e.jsxs)("p",{className:"text-base text-muted-foreground",children:["Auteur : ",$(t.author)]}),(0,e.jsxs)("p",{className:"text-base text-muted-foreground",children:["Cr\xE9\xE9e le : ",new Date(t.createdAt).toLocaleString()]})]}),(0,e.jsxs)(J,{className:"p-4 sm:p-6 flex justify-between gap-3",children:[(0,e.jsx)(a,{asChild:!0,variant:"outline",className:"flex-1 h-12 text-base",children:(0,e.jsx)(p,{prefetch:"intent",to:`/o/note/view/${t.id}`,children:(0,e.jsx)(b,{className:"mr-2 h-5 w-5"})})}),(0,e.jsx)(a,{asChild:!0,variant:"outline",className:"flex-1 h-12 text-base",children:(0,e.jsx)(p,{prefetch:"intent",to:`/o/note/edit/${t.id}`,children:(0,e.jsx)(w,{className:"mr-2 h-5 w-5"})})}),(0,e.jsxs)(C,{open:P===t.id,onOpenChange:i=>u(i?t.id:null),children:[(0,e.jsx)(D,{asChild:!0,children:(0,e.jsx)(a,{variant:"destructive",className:"flex-1 h-12 text-base",children:(0,e.jsx)(N,{className:"mr-2 h-5 w-5"})})}),(0,e.jsxs)(y,{className:"sm:max-w-[425px]",children:[(0,e.jsxs)(T,{children:[(0,e.jsx)(B,{className:"text-xl",children:"\xCAtes-vous s\xFBr de vouloir supprimer cette note ?"}),(0,e.jsx)(S,{className:"text-base",children:"Cette action ne peut pas \xEAtre annul\xE9e."})]}),(0,e.jsxs)(L,{className:"gap-3 sm:gap-0",children:[(0,e.jsx)(a,{variant:"outline",onClick:()=>u(null),className:"h-12 text-base",children:"Annuler"}),(0,e.jsx)(a,{variant:"destructive",onClick:()=>R(t.id),disabled:g,className:"h-12 text-base",children:g?"Suppression...":"Supprimer"})]})]})]})]})]},t.id))}):(0,e.jsx)("div",{className:"rounded-lg border overflow-x-auto",children:(0,e.jsxs)(_,{children:[(0,e.jsx)(ee,{children:(0,e.jsxs)(v,{children:[(0,e.jsx)(o,{className:"text-base whitespace-nowrap",children:"Titre"}),(0,e.jsx)(o,{className:"text-base whitespace-nowrap hidden sm:table-cell",children:"Auteur"}),(0,e.jsx)(o,{className:"text-base whitespace-nowrap",children:"Visibilit\xE9"}),(0,e.jsx)(o,{className:"text-base whitespace-nowrap hidden md:table-cell",children:"Date de cr\xE9ation"}),(0,e.jsx)(o,{className:"text-base text-right",children:"Actions"})]})}),(0,e.jsx)(te,{children:l.results.map(t=>(0,e.jsxs)(v,{children:[(0,e.jsx)(n,{className:"font-medium text-base",children:t.title}),(0,e.jsx)(n,{className:"text-base hidden sm:table-cell",children:$(t.author)}),(0,e.jsx)(n,{children:(0,e.jsxs)(se,{variant:t.visibility==="Private"?"secondary":t.visibility==="Public"?"default":"outline",className:"h-8 text-base px-3 py-1",children:[getVisibilityIcon(t.visibility),(0,e.jsx)("span",{className:"ml-2",children:t.visibility})]})}),(0,e.jsx)(n,{className:"text-base hidden md:table-cell",children:new Date(t.createdAt).toLocaleString()}),(0,e.jsx)(n,{children:(0,e.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,e.jsx)(a,{asChild:!0,variant:"outline",className:"h-12 text-base px-3",children:(0,e.jsx)(p,{prefetch:"intent",to:`/o/note/view/${t.id}`,children:(0,e.jsx)(b,{className:"h-5 w-5"})})}),(0,e.jsx)(a,{asChild:!0,variant:"outline",className:"h-12 text-base px-3",children:(0,e.jsx)(p,{prefetch:"intent",to:`/o/note/edit/${t.id}`,children:(0,e.jsx)(w,{className:"h-5 w-5"})})}),(0,e.jsxs)(C,{open:P===t.id,onOpenChange:i=>u(i?t.id:null),children:[(0,e.jsx)(D,{asChild:!0,children:(0,e.jsx)(a,{variant:"destructive",className:"h-12 text-base px-3",children:(0,e.jsx)(N,{className:"h-5 w-5"})})}),(0,e.jsxs)(y,{className:"sm:max-w-[425px]",children:[(0,e.jsxs)(T,{children:[(0,e.jsx)(B,{className:"text-xl",children:"\xCAtes-vous s\xFBr de vouloir supprimer cette note ?"}),(0,e.jsx)(S,{className:"text-base",children:"Cette action ne peut pas \xEAtre annul\xE9e."})]}),(0,e.jsxs)(L,{className:"gap-3 sm:gap-0",children:[(0,e.jsx)(a,{variant:"outline",onClick:()=>u(null),className:"h-12 text-base",children:"Annuler"}),(0,e.jsx)(a,{variant:"destructive",onClick:()=>R(t.id),disabled:g,className:"h-12 text-base",children:g?"Suppression...":"Supprimer"})]})]})]})]})})]},t.id))})]})}):(0,e.jsx)(Z,{type:"notes",view:d}),l.totalResults>0&&(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4",children:[(0,e.jsx)(a,{onClick:()=>h(t=>(t.set("page",(c-1).toString()),t)),disabled:c===1,className:"w-full sm:w-auto h-12 text-base",children:"Pr\xE9c\xE9dent"}),(0,e.jsxs)("span",{className:"text-base",children:["Page ",c," sur ",Math.ceil(l.totalResults/x)]}),(0,e.jsx)(a,{onClick:()=>h(t=>(t.set("page",(c+1).toString()),t)),disabled:c*x>=l.totalResults,className:"w-full sm:w-auto h-12 text-base",children:"Suivant"})]})]}):null}export{ie as default};
